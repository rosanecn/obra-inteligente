<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Obra Inteligente v8.0 - Or√ßamento Profissional</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #e8f5e9 0%, #fff9c4 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .header h1 {
            color: #66bb6a;
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        .header p {
            color: #666;
            font-size: 1.1em;
        }
        
        .btn-home {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin: 30px 0;
        }
        
        .btn {
            padding: 40px 20px;
            border: none;
            border-radius: 15px;
            font-size: 1.3em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            color: white;
            text-align: center;
        }
        
        .btn:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #81c784 0%, #66bb6a 100%);
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, #fff59d 0%, #ffee58 100%);
            color: #333;
        }
        
        .btn-tertiary {
            background: linear-gradient(135deg, #90caf9 0%, #64b5f6 100%);
        }
        
        .btn-quaternary {
            background: linear-gradient(135deg, #a5d6a7 0%, #4caf50 100%);
        }
        
        .btn-back {
            background: #f5f5f5;
            color: #666;
            padding: 12px 24px;
            margin-bottom: 20px;
            display: inline-block;
            font-size: 1em;
            border-radius: 8px;
            cursor: pointer;
            border: none;
        }
        
        .form-group {
            margin-bottom: 25px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            color: #1a1a1a;
            font-weight: 600;
            font-size: 1.05em;
            text-align: left;
        }
        
        input, select {
            width: 100%;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 1em;
            transition: border 0.3s;
        }
        
        input:focus, select:focus {
            outline: none;
            border-color: #66bb6a;
        }
        
        .grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        
        .material-option {
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
            font-size: 0.9em;
            background: white;
        }
        
        .material-option:hover {
            border-color: #66bb6a;
            background: #f1f8e9;
        }
        
        .material-option.selected {
            border-color: #66bb6a;
            background: linear-gradient(135deg, #e8f5e920 0%, #66bb6a20 100%);
        }
        
        .material-option.eco {
            border-color: #4caf50;
            background: #e8f5e9;
        }
        
        .material-option.eco.selected {
            background: linear-gradient(135deg, #4caf5030 0%, #81c78430 100%);
        }
        
        .eco-badge {
            display: inline-block;
            background: #4caf50;
            color: white;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 0.75em;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .wall-item {
            background: #f9f9f9;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 10px;
            border: 1px solid #e0e0e0;
        }
        
        .btn-add-wall {
            background: #66bb6a;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9em;
            margin-top: 10px;
        }
        
        .btn-remove-wall {
            background: #ef5350;
            color: white;
            border: none;
            padding: 5px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.85em;
            float: right;
        }
        
        .result {
            background: linear-gradient(135deg, #f5f5f5 0%, #e8e8e8 100%);
            padding: 30px;
            border-radius: 15px;
            margin-top: 30px;
        }
        
        .result h2 {
            color: #66bb6a;
            margin-bottom: 20px;
            font-size: 1.8em;
        }
        
        .result h3 {
            color: #333;
            margin-top: 20px;
            margin-bottom: 10px;
            font-size: 1.3em;
        }
        
        .breakdown {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
            border-left: 4px solid #66bb6a;
        }
        
        .breakdown-item {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid #f0f0f0;
        }
        
        .breakdown-item:last-child {
            border-bottom: none;
            font-weight: bold;
            font-size: 1.1em;
            color: #66bb6a;
        }
        
        .contingency-box {
            background: #fff9c4;
            padding: 20px;
            border-radius: 10px;
            border: 2px solid #ffeb3b;
            margin: 20px 0;
        }
        
        .contingency-box h3 {
            color: #f57c00;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .contingency-item {
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .budget-card {
            padding: 25px;
            border-radius: 15px;
            margin: 20px 0;
            color: white;
            text-align: center;
        }
        
        .budget-realistic {
            background: linear-gradient(135deg, #ffb74d 0%, #ffa726 100%);
        }
        
        .budget-safe {
            background: linear-gradient(135deg, #81c784 0%, #66bb6a 100%);
        }
        
        .schedule {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            border-left: 4px solid #64b5f6;
        }
        
        .schedule-item {
            padding: 15px;
            background: #f5f5f5;
            border-radius: 8px;
            margin: 10px 0;
        }
        
        .screen {
            display: none;
        }
        
        .screen.active {
            display: block;
        }
        
        .hidden {
            display: none !important;
        }
        
        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px;
            background: #f9f9f9;
            border-radius: 8px;
            margin: 10px 0;
        }
        
        .checkbox-group input[type="checkbox"] {
            width: auto;
            margin: 0;
        }
        
        .checkbox-group label {
            margin: 0;
            font-weight: normal;
            color: #555;
        }
        
        .info-box {
            background: #e3f2fd;
            border-left: 4px solid #2196f3;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            color: #1976d2;
        }
        
        .warning-box {
            background: #ffebee;
            border-left: 4px solid #f44336;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            color: #c62828;
            font-weight: 600;
        }
        
        .eco-impact {
            background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%);
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            border: 2px solid #4caf50;
        }
        
        .eco-impact h3 {
            color: #2e7d32;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .tracking-item {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
            border-left: 4px solid #ccc;
        }
        
        .tracking-item.completed {
            border-left-color: #66bb6a;
            background: #f1f8e9;
        }
        
        .tracking-item.delayed {
            border-left-color: #ff9800;
            background: #fff3e0;
        }
        
        .tracking-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .tracking-progress {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 10px 0;
        }
        
        .tracking-progress input[type="range"] {
            flex: 1;
            padding: 0;
        }
        
        .tracking-progress span {
            min-width: 50px;
            font-weight: bold;
            color: #66bb6a;
        }
        
        .tracking-notes {
            margin-top: 10px;
        }
        
        .tracking-notes textarea {
            width: 100%;
            min-height: 60px;
            padding: 10px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-family: inherit;
            font-size: 0.95em;
            resize: vertical;
        }
        
        .tracking-notes textarea:focus {
            outline: none;
            border-color: #66bb6a;
        }
        
        .delay-checkbox {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-top: 10px;
            color: #f57c00;
            font-weight: 600;
        }
        
        .progress-bar {
            width: 100%;
            height: 40px;
            background: #e0e0e0;
            border-radius: 20px;
            overflow: hidden;
            margin: 20px 0;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #66bb6a 0%, #4caf50 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            transition: width 0.5s ease;
        }
        
        .saved-budget-card {
            background: white;
            padding: 15px;
            border-radius: 10px;
            margin: 10px 0;
            border: 2px solid #e0e0e0;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .saved-budget-card:hover {
            border-color: #66bb6a;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .saved-budget-card.selected {
            border-color: #66bb6a;
            background: #f1f8e9;
        }
        
        .reverse-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
            border: 2px solid #e0e0e0;
        }
        
        .included {
            color: #66bb6a;
            font-weight: 600;
            margin: 5px 0;
        }
        
        .optional {
            color: #ff9800;
            margin: 5px 0;
        }
        
        .sustainability-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
            border: 2px solid #4caf50;
        }
        
        .sustainability-card h4 {
            color: #2e7d32;
            margin-bottom: 10px;
        }
        
        .sustainability-option {
            background: #f1f8e9;
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            border-left: 4px solid #4caf50;
        }
        
        .cost-detail {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            color: #555;
        }
        
        .total-price {
            font-size: 2em;
            font-weight: bold;
            color: #66bb6a;
            text-align: center;
            margin: 20px 0;
            padding: 20px;
            background: white;
            border-radius: 10px;
        }
        
        .worker-input {
            background: #f9f9f9;
            padding: 15px;
            border-radius: 10px;
            margin: 10px 0;
            border: 1px solid #e0e0e0;
        }
        
        .worker-input label {
            font-size: 1.1em;
            color: #1a1a1a;
            font-weight: 600;
            margin-bottom: 10px;
        }
        
        .worker-inputs-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 10px;
        }
        
        .worker-inputs-row div {
            display: flex;
            flex-direction: column;
        }
        
        .worker-inputs-row label {
            font-size: 0.9em;
            font-weight: normal;
            color: #555;
            margin-bottom: 5px;
        }
        
        .tracking-comment {
            width: 100%;
            padding: 10px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            margin-top: 10px;
            font-size: 0.9em;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            resize: vertical;
            min-height: 60px;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- HOME -->
        <div id="home" class="screen active">
            <div class="header">
                <h1>üèóÔ∏è Obra Inteligente v8.0</h1>
                <p>Or√ßamento profissional, sustent√°vel e inteligente!</p>
            </div>
            
            <div class="btn-home">
                <button class="btn btn-primary" onclick="showScreen('reforma')">
                    üí∞ Fazer Or√ßamento
                </button>
                <button class="btn btn-secondary" onclick="showScreen('reverse')">
                    üîÑ Tenho R$ X
                </button>
                <button class="btn btn-tertiary" onclick="showScreen('tracking')">
                    üìä Gerenciar Obra
                </button>
                <button class="btn btn-quaternary" onclick="showScreen('sustainability')">
                    üå± Estrat√©gias Sustent√°veis
                </button>
            </div>
        </div>

        <!-- FAZER OR√áAMENTO -->
        <div id="reforma" class="screen">
            <button class="btn-back" onclick="showScreen('home')">‚Üê Voltar</button>
            <h2>üí∞ Novo Or√ßamento</h2>
            
            <div class="form-group">
                <label>Estado (Esp√≠rito Santo = Base)</label>
                <select id="state" onchange="updateState()">
                    <option value="1.0">Esp√≠rito Santo (ES) - Base</option>
                    <option value="1.15">S√£o Paulo (SP) - +15%</option>
                    <option value="1.12">Rio de Janeiro (RJ) - +12%</option>
                    <option value="0.92">Minas Gerais (MG) - -8%</option>
                    <option value="0.88">Bahia (BA) - -12%</option>
                    <option value="1.08">Paran√° (PR) - +8%</option>
                    <option value="1.10">Santa Catarina (SC) - +10%</option>
                    <option value="1.07">Rio Grande do Sul (RS) - +7%</option>
                </select>
            </div>
            
            <div class="form-group">
                <label>Tipo de Reforma</label>
                <select id="reform-type" onchange="showReformForm()">
                    <option value="">Selecione...</option>
                    <option value="cozinha">üç≥ Cozinha</option>
                    <option value="banheiro">üöø Banheiro</option>
                    <option value="quarto">üõèÔ∏è Quarto</option>
                    <option value="sala">üõãÔ∏è Sala</option>
                    <option value="casa">üè† Casa Pequena</option>
                </select>
            </div>

            <!-- FORMUL√ÅRIO COZINHA -->
            <div id="form-cozinha" class="hidden">
                <h3>üç≥ Cozinha</h3>
                
                <div class="form-group">
                    <label>√Årea da Cozinha (m¬≤)</label>
                    <input type="number" id="coz-area" placeholder="Ex: 12" step="0.1">
                </div>

                <div class="form-group">
                    <label>Piso</label>
                    <select id="coz-piso">
                        <option value="95">Porcelanato Portobello - R$ 95/m¬≤</option>
                        <option value="105">Porcelanato Eliane Eco üå± - R$ 105/m¬≤</option>
                        <option value="85">Cer√¢mica Cecrisa - R$ 85/m¬≤</option>
                        <option value="75">Cer√¢mica Eliane - R$ 75/m¬≤</option>
                        <option value="custom">üí∞ Outro (digitar valor)</option>
                    </select>
                    <input type="number" id="coz-piso-custom" class="hidden" placeholder="Valor por m¬≤" step="0.01">
                </div>

                <div class="form-group">
                    <label>Revestimento de Parede</label>
                    <div id="coz-walls"></div>
                    <button class="btn-add-wall" onclick="addWall('coz')">+ Adicionar Parede</button>
                    <div class="info-box">üí° Dica: Altura padr√£o cozinha = 1,5m</div>
                </div>

                <div class="checkbox-group">
                    <input type="checkbox" id="coz-pintura">
                    <label for="coz-pintura">üé® Adicionar Pintura (paredes n√£o revestidas)</label>
                </div>

                <div id="coz-pintura-options" class="hidden">
                    <div class="form-group">
                        <label>√Årea para Pintura (m¬≤ de parede)</label>
                        <input type="number" id="coz-pintura-area" placeholder="Ex: 20" step="0.1">
                    </div>
                    <div class="form-group">
                        <label>Tipo de Tinta</label>
                        <select id="coz-pintura-tipo">
                            <option value="25">Suvinil L√°tex - R$ 25/m¬≤</option>
                            <option value="30">Coral Acr√≠lica - R$ 30/m¬≤</option>
                            <option value="35">Sherwin Williams Eco üå± - R$ 35/m¬≤</option>
                            <option value="custom">üí∞ Outro (digitar valor)</option>
                        </select>
                        <input type="number" id="coz-pintura-custom" class="hidden" placeholder="Valor por m¬≤" step="0.01">
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="coz-pintura-preparo">
                        <label for="coz-pintura-preparo">Precisa lixar e aplicar massa corrida</label>
                    </div>
                </div>

                <div class="checkbox-group">
                    <input type="checkbox" id="coz-bancada">
                    <label for="coz-bancada">Incluir Bancada</label>
                </div>

                <div id="coz-bancada-options" class="hidden">
                    <div class="form-group">
                        <label>Comprimento da Bancada (metros lineares)</label>
                        <input type="number" id="coz-bancada-comp" placeholder="Ex: 2.5" step="0.1">
                        <div class="info-box">üí° Largura padr√£o: 60cm</div>
                    </div>
                    <div class="form-group">
                        <label>Tipo de Bancada</label>
                        <select id="coz-bancada-tipo">
                            <option value="350">Granito - R$ 350/m linear</option>
                            <option value="450">M√°rmore - R$ 450/m linear</option>
                            <option value="550">Quartzo - R$ 550/m linear</option>
                            <option value="600">Silestone Eco üå± - R$ 600/m linear</option>
                            <option value="custom">üí∞ Outro (digitar valor)</option>
                        </select>
                        <input type="number" id="coz-bancada-custom" class="hidden" placeholder="Valor por m linear" step="0.01">
                    </div>
                </div>

                <div class="checkbox-group">
                    <input type="checkbox" id="coz-pia">
                    <label for="coz-pia">Trocar Pia</label>
                </div>

                <div id="coz-pia-options" class="hidden">
                    <div class="form-group">
                        <label>Tipo de Pia</label>
                        <select id="coz-pia-tipo">
                            <option value="400">Pia Inox Simples - R$ 400</option>
                            <option value="600">Pia Inox Dupla - R$ 600</option>
                            <option value="800">Pia Granito - R$ 800</option>
                            <option value="custom">üí∞ Outro (digitar valor)</option>
                        </select>
                        <input type="number" id="coz-pia-custom" class="hidden" placeholder="Valor total" step="0.01">
                    </div>
                </div>

                <div class="checkbox-group">
                    <input type="checkbox" id="coz-eletrica">
                    <label for="coz-eletrica">‚ö° Refazer El√©trica</label>
                </div>

                <div class="checkbox-group">
                    <input type="checkbox" id="coz-hidraulica">
                    <label for="coz-hidraulica">üíß Refazer Hidr√°ulica</label>
                </div>

                <div class="checkbox-group">
                    <input type="checkbox" id="coz-reuso">
                    <label for="coz-reuso">‚ôªÔ∏è Sistema de Reaproveitamento de √Ågua</label>
                </div>

                <div id="coz-reuso-options" class="hidden">
                    <div class="info-box">
                        <strong>üíß Sistema de Re√∫so de √Ågua</strong><br>
                        Aproveita √°gua da pia para regar plantas ou limpeza<br>
                        Inclui: tubula√ß√£o, reservat√≥rio 100L, filtro b√°sico
                    </div>
                    <div class="form-group">
                        <label>Tipo de Sistema</label>
                        <select id="coz-reuso-tipo">
                            <option value="800">Sistema B√°sico - R$ 800</option>
                            <option value="1500">Sistema Intermedi√°rio - R$ 1.500</option>
                            <option value="2500">Sistema Completo - R$ 2.500</option>
                        </select>
                    </div>
                </div>

                <div class="checkbox-group">
                    <input type="checkbox" id="coz-demolir">
                    <label for="coz-demolir">üî® Demolir Parede</label>
                </div>

                <div id="coz-demolir-options" class="hidden">
                    <div class="form-group">
                        <label>Metragem da Parede (m¬≤)</label>
                        <input type="number" id="coz-demolir-area" placeholder="Ex: 8" step="0.1">
                    </div>
                    <div class="warning-box">
                        ‚ö†Ô∏è ATEN√á√ÉO: Antes de demolir qualquer parede, CONSULTE UM ENGENHEIRO para verificar se n√£o √© uma parede estrutural!
                    </div>
                </div>

                <button class="btn btn-primary" onclick="calculateBudget('cozinha')" style="width: 100%; margin-top: 20px;">
                    Calcular Or√ßamento
                </button>
            </div>

            <!-- FORMUL√ÅRIO BANHEIRO -->
            <div id="form-banheiro" class="hidden">
                <h3>üöø Banheiro</h3>
                
                <div class="form-group">
                    <label>√Årea do Banheiro (m¬≤)</label>
                    <input type="number" id="ban-area" placeholder="Ex: 6" step="0.1">
                </div>

                <div class="form-group">
                    <label>Piso</label>
                    <select id="ban-piso">
                        <option value="95">Porcelanato Portobello - R$ 95/m¬≤</option>
                        <option value="105">Porcelanato Eliane Eco üå± - R$ 105/m¬≤</option>
                        <option value="85">Cer√¢mica Cecrisa - R$ 85/m¬≤</option>
                        <option value="75">Cer√¢mica Eliane - R$ 75/m¬≤</option>
                        <option value="custom">üí∞ Outro (digitar valor)</option>
                    </select>
                    <input type="number" id="ban-piso-custom" class="hidden" placeholder="Valor por m¬≤" step="0.01">
                </div>

                <div class="form-group">
                    <label>Revestimento de Parede</label>
                    <div id="ban-walls"></div>
                    <button class="btn-add-wall" onclick="addWall('ban')">+ Adicionar Parede</button>
                    <div class="info-box">üí° Dica: Altura comum banheiro = 2,0m (at√© o teto) ou 1,2m (meia parede)</div>
                </div>

                <div class="checkbox-group">
                    <input type="checkbox" id="ban-pintura">
                    <label for="ban-pintura">üé® Adicionar Pintura (paredes n√£o revestidas)</label>
                </div>

                <div id="ban-pintura-options" class="hidden">
                    <div class="form-group">
                        <label>√Årea para Pintura (m¬≤ de parede)</label>
                        <input type="number" id="ban-pintura-area" placeholder="Ex: 15" step="0.1">
                    </div>
                    <div class="form-group">
                        <label>Tipo de Tinta</label>
                        <select id="ban-pintura-tipo">
                            <option value="30">Tinta Anti-Mofo Suvinil - R$ 30/m¬≤</option>
                            <option value="35">Tinta Anti-Mofo Coral - R$ 35/m¬≤</option>
                            <option value="40">Tinta Anti-Mofo Eco üå± - R$ 40/m¬≤</option>
                            <option value="custom">üí∞ Outro (digitar valor)</option>
                        </select>
                        <input type="number" id="ban-pintura-custom" class="hidden" placeholder="Valor por m¬≤" step="0.01">
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="ban-pintura-preparo">
                        <label for="ban-pintura-preparo">Precisa lixar e aplicar massa corrida</label>
                    </div>
                </div>

                <div class="checkbox-group">
                    <input type="checkbox" id="ban-loucas">
                    <label for="ban-loucas">Trocar Lou√ßas</label>
                </div>

                <div id="ban-loucas-options" class="hidden">
                    <div class="form-group">
                        <label>Kit de Lou√ßas</label>
                        <select id="ban-loucas-tipo">
                            <option value="800">Kit B√°sico Deca (vaso + pia + torneiras) - R$ 800</option>
                            <option value="1200">Kit Intermedi√°rio Deca (vaso + pia + chuveiro + torneiras) - R$ 1.200</option>
                            <option value="1800">Kit Premium Deca (vaso + pia + chuveiro + torneiras + metais) - R$ 1.800</option>
                            <option value="2200">Kit Eco Deca üå± (economia de √°gua 40%) - R$ 2.200</option>
                            <option value="custom">üí∞ Outro (digitar valor)</option>
                        </select>
                        <input type="number" id="ban-loucas-custom" class="hidden" placeholder="Valor total" step="0.01">
                    </div>
                    <div class="info-box">
                        <strong>Kit Inclui:</strong><br>
                        ‚Ä¢ Vaso sanit√°rio com caixa acoplada<br>
                        ‚Ä¢ Pia/Cuba<br>
                        ‚Ä¢ Torneiras<br>
                        ‚Ä¢ Chuveiro (kits intermedi√°rio e premium)
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="ban-banheira">
                        <label for="ban-banheira">üõÅ Adicionar Banheira</label>
                    </div>
                    <div id="ban-banheira-options" class="hidden">
                        <select id="ban-banheira-tipo">
                            <option value="1500">Banheira Simples - R$ 1.500</option>
                            <option value="3000">Banheira Hidromassagem - R$ 3.000</option>
                        </select>
                    </div>
                </div>

                <div class="checkbox-group">
                    <input type="checkbox" id="ban-boxe">
                    <label for="ban-boxe">Incluir Box</label>
                </div>

                <div id="ban-boxe-options" class="hidden">
                    <div class="form-group">
                        <label>Tipo de Box</label>
                        <select id="ban-boxe-tipo">
                            <option value="600">Box Acr√≠lico - R$ 600</option>
                            <option value="900">Box Vidro Temperado - R$ 900</option>
                            <option value="1200">Box Vidro Premium - R$ 1.200</option>
                            <option value="custom">üí∞ Outro (digitar valor)</option>
                        </select>
                        <input type="number" id="ban-boxe-custom" class="hidden" placeholder="Valor total" step="0.01">
                    </div>
                </div>

                <div class="checkbox-group">
                    <input type="checkbox" id="ban-eletrica">
                    <label for="ban-eletrica">‚ö° Refazer El√©trica</label>
                </div>

                <div class="checkbox-group">
                    <input type="checkbox" id="ban-hidraulica">
                    <label for="ban-hidraulica">üíß Refazer Hidr√°ulica</label>
                </div>

                <div class="checkbox-group">
                    <input type="checkbox" id="ban-reuso">
                    <label for="ban-reuso">‚ôªÔ∏è Sistema de Reaproveitamento de √Ågua do Chuveiro</label>
                </div>

                <div id="ban-reuso-options" class="hidden">
                    <div class="info-box">
                        <strong>üíß Sistema de Re√∫so de √Ågua do Chuveiro</strong><br>
                        Aproveita √°gua do banho para vaso sanit√°rio e limpeza<br>
                        Economia de at√© 40% no consumo de √°gua!
                    </div>
                    <div class="form-group">
                        <label>Tipo de Sistema</label>
                        <select id="ban-reuso-tipo">
                            <option value="1200">Sistema B√°sico - R$ 1.200</option>
                            <option value="2000">Sistema Intermedi√°rio - R$ 2.000</option>
                            <option value="3500">Sistema Completo - R$ 3.500</option>
                        </select>
                    </div>
                </div>

                <div class="checkbox-group">
                    <input type="checkbox" id="ban-demolir">
                    <label for="ban-demolir">üî® Demolir Parede</label>
                </div>

                <div id="ban-demolir-options" class="hidden">
                    <div class="form-group">
                        <label>Metragem da Parede (m¬≤)</label>
                        <input type="number" id="ban-demolir-area" placeholder="Ex: 5" step="0.1">
                    </div>
                    <div class="warning-box">
                        ‚ö†Ô∏è ATEN√á√ÉO: Antes de demolir qualquer parede, CONSULTE UM ENGENHEIRO para verificar se n√£o √© uma parede estrutural!
                    </div>
                </div>

                <button class="btn btn-primary" onclick="calculateBudget('banheiro')" style="width: 100%; margin-top: 20px;">
                    Calcular Or√ßamento
                </button>
            </div>

            <!-- FORMUL√ÅRIO CASA PEQUENA -->
            <div id="form-casa" class="hidden">
                <h3>üè† Casa Pequena</h3>
                
                <div class="form-group">
                    <label>√Årea Total da Casa (m¬≤)</label>
                    <input type="number" id="casa-area" placeholder="Ex: 60" step="0.1">
                </div>

                <div class="info-box">
                    üí° Detalhamento opcional dos c√¥modos (a soma deve ser pr√≥xima da √°rea total)
                </div>

                <div class="grid-2">
                    <div>
                        <label>Quartos (m¬≤)</label>
                        <input type="number" id="casa-quartos" placeholder="Ex: 20" step="0.1">
                    </div>
                    <div>
                        <label>Sala (m¬≤)</label>
                        <input type="number" id="casa-sala" placeholder="Ex: 15" step="0.1">
                    </div>
                    <div>
                        <label>Cozinha (m¬≤)</label>
                        <input type="number" id="casa-cozinha" placeholder="Ex: 10" step="0.1">
                    </div>
                    <div>
                        <label>Banheiro (m¬≤)</label>
                        <input type="number" id="casa-banheiro" placeholder="Ex: 6" step="0.1">
                    </div>
                </div>

                <h4 style="margin-top: 30px;">Estrutura</h4>

                <div class="form-group">
                    <label>Funda√ß√£o</label>
                    <select id="casa-fundacao">
                        <option value="180">Sapata Corrida - R$ 180/m¬≤</option>
                        <option value="220">Radier - R$ 220/m¬≤</option>
                        <option value="250">Estacas - R$ 250/m¬≤</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>Alvenaria</label>
                    <select id="casa-alvenaria">
                        <option value="320">Tijolo Cer√¢mico - R$ 320/m¬≤</option>
                        <option value="380">Bloco de Concreto - R$ 380/m¬≤</option>
                        <option value="420">Tijolo Ecol√≥gico üå± - R$ 420/m¬≤</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>Cobertura/Telhado</label>
                    <select id="casa-telhado">
                        <option value="180">Telha Cer√¢mica - R$ 180/m¬≤</option>
                        <option value="150">Telha Fibrocimento - R$ 150/m¬≤</option>
                        <option value="220">Telha Met√°lica - R$ 220/m¬≤</option>
                        <option value="280">Telha Ecol√≥gica üå± - R$ 280/m¬≤</option>
                        <option value="350">Laje + Telha - R$ 350/m¬≤</option>
                    </select>
                </div>

                <h4 style="margin-top: 30px;">Esquadrias</h4>

                <div class="form-group">
                    <label>Quantidade de Portas</label>
                    <input type="number" id="casa-portas-qtd" placeholder="Ex: 6" min="1">
                </div>

                <div class="form-group">
                    <label>Tipo de Portas</label>
                    <select id="casa-portas">
                        <option value="180">Madeira Compensada - R$ 180/un</option>
                        <option value="280">Madeira Maci√ßa - R$ 280/un</option>
                        <option value="350">MDF - R$ 350/un</option>
                        <option value="450">MDF Premium - R$ 450/un</option>
                    </select>
                    <div class="info-box">‚ö†Ô∏è MDF geralmente √© mais caro que madeira comum</div>
                </div>

                <div class="form-group">
                    <label>Quantidade de Janelas</label>
                    <input type="number" id="casa-janelas-qtd" placeholder="Ex: 8" min="1">
                </div>

                <div class="form-group">
                    <label>Tipo de Janelas</label>
                    <select id="casa-janelas">
                        <option value="250">Alum√≠nio B√°sico - R$ 250/un</option>
                        <option value="350">Alum√≠nio com Vidro - R$ 350/un</option>
                        <option value="450">Alum√≠nio Premium - R$ 450/un</option>
                        <option value="600">PVC com Vidro Duplo üå± - R$ 600/un</option>
                    </select>
                </div>

                <h4 style="margin-top: 30px;">Acabamentos</h4>

                <div class="form-group">
                    <label>Piso Geral</label>
                    <select id="casa-piso">
                        <option value="85">Cer√¢mica B√°sica - R$ 85/m¬≤</option>
                        <option value="95">Porcelanato - R$ 95/m¬≤</option>
                        <option value="105">Porcelanato Eco üå± - R$ 105/m¬≤</option>
                        <option value="120">Piso Bambu üå± - R$ 120/m¬≤</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>Pintura</label>
                    <select id="casa-pintura">
                        <option value="25">Tinta L√°tex - R$ 25/m¬≤</option>
                        <option value="30">Tinta Acr√≠lica - R$ 30/m¬≤</option>
                        <option value="35">Tinta Eco üå± - R$ 35/m¬≤</option>
                    </select>
                </div>

                <div class="checkbox-group">
                    <input type="checkbox" id="casa-pintura-preparo">
                    <label for="casa-pintura-preparo">Precisa lixar e aplicar massa corrida</label>
                </div>

                <h4 style="margin-top: 30px;">Instala√ß√µes</h4>

                <div class="checkbox-group">
                    <input type="checkbox" id="casa-eletrica" checked>
                    <label for="casa-eletrica">‚ö° Instala√ß√£o El√©trica Completa</label>
                </div>

                <div class="checkbox-group">
                    <input type="checkbox" id="casa-hidraulica" checked>
                    <label for="casa-hidraulica">üíß Instala√ß√£o Hidr√°ulica Completa</label>
                </div>

                <div class="checkbox-group">
                    <input type="checkbox" id="casa-reuso">
                    <label for="casa-reuso">‚ôªÔ∏è Sistema de Reaproveitamento de √Ågua</label>
                </div>

                <div id="casa-reuso-options" class="hidden">
                    <div class="form-group">
                        <label>Tipo de Sistema</label>
                        <select id="casa-reuso-tipo">
                            <option value="2500">Sistema B√°sico (√°gua cinza) - R$ 2.500</option>
                            <option value="5000">Sistema Intermedi√°rio (cisterna 500L) - R$ 5.000</option>
                            <option value="8000">Sistema Completo (cisterna 1000L + filtragem) - R$ 8.000</option>
                        </select>
                    </div>
                </div>

                <div class="checkbox-group">
                    <input type="checkbox" id="casa-solar">
                    <label for="casa-solar">‚òÄÔ∏è Preparar para Energia Solar (estrutura no telhado)</label>
                </div>

                <div id="casa-solar-options" class="hidden">
                    <div class="info-box">
                        Adiciona refor√ßo estrutural no telhado e passa condu√≠tes preparados.<br>
                        Custo: R$ 2.000 (economiza R$ 3.000 se instalar pain√©is depois)
                    </div>
                </div>

                <button class="btn btn-primary" onclick="calculateBudget('casa')" style="width: 100%; margin-top: 20px;">
                    Calcular Or√ßamento
                </button>
            </div>

            <!-- FORMUL√ÅRIO QUARTO -->
            <div id="form-quarto" class="hidden">
                <h3>üõèÔ∏è Quarto</h3>
                
                <div class="form-group">
                    <label>√Årea do Quarto (m¬≤)</label>
                    <input type="number" id="qua-area" placeholder="Ex: 12" step="0.1">
                </div>

                <div class="form-group">
                    <label>Piso</label>
                    <select id="qua-piso">
                        <option value="95">Porcelanato Portobello - R$ 95/m¬≤</option>
                        <option value="105">Porcelanato Eliane Eco üå± - R$ 105/m¬≤</option>
                        <option value="90">Laminado Durafloor - R$ 90/m¬≤</option>
                        <option value="95">Laminado Eucafloor - R$ 95/m¬≤</option>
                        <option value="120">Piso Bambu Bambutec üå± - R$ 120/m¬≤</option>
                        <option value="custom">üí∞ Outro (digitar valor)</option>
                    </select>
                    <input type="number" id="qua-piso-custom" class="hidden" placeholder="Valor por m¬≤" step="0.01">
                </div>

                <h4 style="margin-top: 20px;">Pintura</h4>

                <div class="checkbox-group">
                    <input type="checkbox" id="qua-pintar-paredes">
                    <label for="qua-pintar-paredes">Pintar Paredes</label>
                </div>

                <div class="checkbox-group">
                    <input type="checkbox" id="qua-pintar-teto">
                    <label for="qua-pintar-teto">Pintar Teto</label>
                </div>

                <div id="qua-pintura-calc" class="hidden">
                    <div class="info-box">
                        üí° √Årea calculada automaticamente: <strong id="qua-pintura-auto">0</strong> m¬≤<br>
                        <small>F√≥rmula: √Årea do quarto √ó 3,8 (considera paredes + teto)</small>
                    </div>
                    <div class="form-group">
                        <label>Confirme ou ajuste a √°rea para pintura (m¬≤)</label>
                        <input type="number" id="qua-pintura-area" placeholder="√Årea calculada" step="0.1">
                    </div>
                </div>

                <div id="qua-pintura-options" class="hidden">
                    <div class="form-group">
                        <label>Tipo de Tinta</label>
                        <select id="qua-pintura-tipo">
                            <option value="25">Suvinil L√°tex - R$ 25/m¬≤</option>
                            <option value="30">Coral Acr√≠lica - R$ 30/m¬≤</option>
                            <option value="35">Sherwin Williams Eco üå± - R$ 35/m¬≤</option>
                            <option value="custom">üí∞ Outro (digitar valor)</option>
                        </select>
                        <input type="number" id="qua-pintura-custom" class="hidden" placeholder="Valor por m¬≤" step="0.01">
                    </div>

                    <div class="checkbox-group">
                        <input type="checkbox" id="qua-pintura-preparo">
                        <label for="qua-pintura-preparo">Precisa lixar e aplicar massa corrida</label>
                    </div>
                </div>

                <div class="checkbox-group">
                    <input type="checkbox" id="qua-eletrica">
                    <label for="qua-eletrica">‚ö° Refazer El√©trica</label>
                </div>

                <div class="checkbox-group">
                    <input type="checkbox" id="qua-demolir">
                    <label for="qua-demolir">üî® Demolir Parede</label>
                </div>

                <div id="qua-demolir-options" class="hidden">
                    <div class="form-group">
                        <label>Metragem da Parede (m¬≤)</label>
                        <input type="number" id="qua-demolir-area" placeholder="Ex: 10" step="0.1">
                    </div>
                    <div class="warning-box">
                        ‚ö†Ô∏è ATEN√á√ÉO: Antes de demolir qualquer parede, CONSULTE UM ENGENHEIRO para verificar se n√£o √© uma parede estrutural!
                    </div>
                </div>

                <button class="btn btn-primary" onclick="calculateBudget('quarto')" style="width: 100%; margin-top: 20px;">
                    Calcular Or√ßamento
                </button>
            </div>

            <!-- FORMUL√ÅRIO SALA -->
            <div id="form-sala" class="hidden">
                <h3>üõãÔ∏è Sala</h3>
                
                <div class="form-group">
                    <label>√Årea da Sala (m¬≤)</label>
                    <input type="number" id="sal-area" placeholder="Ex: 20" step="0.1">
                </div>

                <div class="form-group">
                    <label>Piso</label>
                    <select id="sal-piso">
                        <option value="95">Porcelanato Portobello - R$ 95/m¬≤</option>
                        <option value="105">Porcelanato Eliane Eco üå± - R$ 105/m¬≤</option>
                        <option value="90">Laminado Durafloor - R$ 90/m¬≤</option>
                        <option value="95">Laminado Eucafloor - R$ 95/m¬≤</option>
                        <option value="120">Piso Bambu Bambutec üå± - R$ 120/m¬≤</option>
                        <option value="custom">üí∞ Outro (digitar valor)</option>
                    </select>
                    <input type="number" id="sal-piso-custom" class="hidden" placeholder="Valor por m¬≤" step="0.01">
                </div>

                <h4 style="margin-top: 20px;">Pintura</h4>

                <div class="checkbox-group">
                    <input type="checkbox" id="sal-pintar-paredes">
                    <label for="sal-pintar-paredes">Pintar Paredes</label>
                </div>

                <div class="checkbox-group">
                    <input type="checkbox" id="sal-pintar-teto">
                    <label for="sal-pintar-teto">Pintar Teto</label>
                </div>

                <div id="sal-pintura-calc" class="hidden">
                    <div class="info-box">
                        üí° √Årea calculada automaticamente: <strong id="sal-pintura-auto">0</strong> m¬≤<br>
                        <small>F√≥rmula: √Årea da sala √ó 3,8 (considera paredes + teto)</small>
                    </div>
                    <div class="form-group">
                        <label>Confirme ou ajuste a √°rea para pintura (m¬≤)</label>
                        <input type="number" id="sal-pintura-area" placeholder="√Årea calculada" step="0.1">
                    </div>
                </div>

                <div id="sal-pintura-options" class="hidden">
                    <div class="form-group">
                        <label>Tipo de Tinta</label>
                        <select id="sal-pintura-tipo">
                            <option value="25">Suvinil L√°tex - R$ 25/m¬≤</option>
                            <option value="30">Coral Acr√≠lica - R$ 30/m¬≤</option>
                            <option value="35">Sherwin Williams Eco üå± - R$ 35/m¬≤</option>
                            <option value="custom">üí∞ Outro (digitar valor)</option>
                        </select>
                        <input type="number" id="sal-pintura-custom" class="hidden" placeholder="Valor por m¬≤" step="0.01">
                    </div>

                    <div class="checkbox-group">
                        <input type="checkbox" id="sal-pintura-preparo">
                        <label for="sal-pintura-preparo">Precisa lixar e aplicar massa corrida</label>
                    </div>
                </div>

                <div class="checkbox-group">
                    <input type="checkbox" id="sal-eletrica">
                    <label for="sal-eletrica">‚ö° Refazer El√©trica</label>
                </div>

                <div class="checkbox-group">
                    <input type="checkbox" id="sal-demolir">
                    <label for="sal-demolir">üî® Demolir Parede</label>
                </div>

                <div id="sal-demolir-options" class="hidden">
                    <div class="form-group">
                        <label>Metragem da Parede (m¬≤)</label>
                        <input type="number" id="sal-demolir-area" placeholder="Ex: 12" step="0.1">
                    </div>
                    <div class="warning-box">
                        ‚ö†Ô∏è ATEN√á√ÉO: Antes de demolir qualquer parede, CONSULTE UM ENGENHEIRO para verificar se n√£o √© uma parede estrutural!
                    </div>
                </div>

                <button class="btn btn-primary" onclick="calculateBudget('sala')" style="width: 100%; margin-top: 20px;">
                    Calcular Or√ßamento
                </button>
            </div>

            <!-- RESULTADO -->
            <div id="result-container"></div>
            <div id="saved-budgets-list"></div>
        </div>

        <!-- TENHO R$ X -->
        <div id="reverse" class="screen">
            <button class="btn-back" onclick="showScreen('home')">‚Üê Voltar</button>
            <h2>üîÑ Tenho R$ X - O Que Posso Fazer?</h2>
            
            <div class="form-group">
                <label>Estado</label>
                <select id="rev-state" onchange="updateState()">
                    <option value="1.0">Esp√≠rito Santo (ES) - Base</option>
                    <option value="1.15">S√£o Paulo (SP) - +15%</option>
                    <option value="1.12">Rio de Janeiro (RJ) - +12%</option>
                    <option value="0.92">Minas Gerais (MG) - -8%</option>
                    <option value="0.88">Bahia (BA) - -12%</option>
                    <option value="1.08">Paran√° (PR) - +8%</option>
                    <option value="1.10">Santa Catarina (SC) - +10%</option>
                    <option value="1.07">Rio Grande do Sul (RS) - +7%</option>
                </select>
            </div>
            
            <div class="form-group">
                <label>Quanto voc√™ tem para investir?</label>
                <input type="number" id="budget-amount" placeholder="Ex: 15000" step="100">
            </div>
            
            <h3>Marque os c√¥modos de interesse:</h3>
            
            <div class="checkbox-group">
                <input type="checkbox" id="rev-cozinha">
                <label for="rev-cozinha">üç≥ Cozinha</label>
            </div>
            <div id="rev-cozinha-area-div" class="hidden">
                <input type="number" id="rev-cozinha-area" placeholder="√Årea da cozinha (m¬≤)" step="0.1">
            </div>
            
            <div class="checkbox-group">
                <input type="checkbox" id="rev-banheiro">
                <label for="rev-banheiro">üöø Banheiro</label>
            </div>
            <div id="rev-banheiro-area-div" class="hidden">
                <input type="number" id="rev-banheiro-area" placeholder="√Årea do banheiro (m¬≤)" step="0.1">
            </div>
            
            <div class="checkbox-group">
                <input type="checkbox" id="rev-quarto">
                <label for="rev-quarto">üõèÔ∏è Quarto</label>
            </div>
            <div id="rev-quarto-area-div" class="hidden">
                <input type="number" id="rev-quarto-area" placeholder="√Årea do quarto (m¬≤)" step="0.1">
            </div>
            
            <div class="checkbox-group">
                <input type="checkbox" id="rev-sala">
                <label for="rev-sala">üõãÔ∏è Sala</label>
            </div>
            <div id="rev-sala-area-div" class="hidden">
                <input type="number" id="rev-sala-area" placeholder="√Årea da sala (m¬≤)" step="0.1">
            </div>
            
            <button class="btn btn-primary" onclick="calculateReverse()" style="width: 100%; margin-top: 20px;">
                Ver Melhor Estrat√©gia
            </button>
            
            <div id="reverse-result"></div>
        </div>

        <!-- GERENCIAR OBRA -->
        <div id="tracking" class="screen">
            <button class="btn-back" onclick="showScreen('home')">‚Üê Voltar</button>
            <h2>üìä Gerenciar Obra</h2>
            
            <div class="info-box">
                üí° <strong>Novo!</strong> Configure sua obra com todos os detalhes para acompanhamento preciso!
            </div>

            <div id="budget-select-list"></div>

            <h3>Configura√ß√£o da Obra</h3>
            
            <div class="form-group">
                <label>Nome do Projeto</label>
                <input type="text" id="project-name" placeholder="Ex: Reforma Cozinha">
            </div>

            <div class="form-group">
                <label>Tipo de Ambiente</label>
                <select id="track-type">
                    <option value="">Selecione...</option>
                    <option value="cozinha">üç≥ Cozinha</option>
                    <option value="banheiro">üöø Banheiro</option>
                    <option value="quarto">üõèÔ∏è Quarto</option>
                    <option value="sala">üõãÔ∏è Sala</option>
                </select>
            </div>

            <div class="form-group">
                <label>√Årea (m¬≤)</label>
                <input type="number" id="track-area" placeholder="Ex: 12" step="0.1">
            </div>

            <h3>Servi√ßos a Realizar</h3>

            <div class="checkbox-group">
                <input type="checkbox" id="track-piso">
                <label for="track-piso">Trocar Piso</label>
            </div>

            <div class="checkbox-group">
                <input type="checkbox" id="track-revestimento">
                <label for="track-revestimento">Trocar Revestimento</label>
            </div>

            <div class="checkbox-group">
                <input type="checkbox" id="track-pintura">
                <label for="track-pintura">Fazer Pintura</label>
            </div>

            <div class="checkbox-group">
                <input type="checkbox" id="track-eletrica">
                <label for="track-eletrica">‚ö° Refazer El√©trica</label>
            </div>

            <div class="checkbox-group">
                <input type="checkbox" id="track-hidraulica">
                <label for="track-hidraulica">üíß Refazer Hidr√°ulica</label>
            </div>

            <div class="checkbox-group">
                <input type="checkbox" id="track-demolir">
                <label for="track-demolir">üî® Demolir Parede</label>
            </div>

            <h3>M√£o de Obra Contratada</h3>

            <div class="worker-input">
                <label>üë∑ Pedreiros</label>
                <div class="worker-inputs-row">
                    <div>
                        <label>Quantidade</label>
                        <input type="number" id="track-pedreiros" placeholder="0" min="0" value="0">
                    </div>
                    <div>
                        <label>Horas/dia</label>
                        <input type="number" id="track-pedreiros-horas" placeholder="8" min="0" step="0.5" value="8">
                    </div>
                </div>
            </div>

            <div class="worker-input">
                <label>üßë‚Äçüîß Ajudantes</label>
                <div class="worker-inputs-row">
                    <div>
                        <label>Quantidade</label>
                        <input type="number" id="track-ajudantes" placeholder="0" min="0" value="0">
                    </div>
                    <div>
                        <label>Horas/dia</label>
                        <input type="number" id="track-ajudantes-horas" placeholder="8" min="0" step="0.5" value="8">
                    </div>
                </div>
            </div>

            <div class="worker-input">
                <label>üé® Pintores</label>
                <div class="worker-inputs-row">
                    <div>
                        <label>Quantidade</label>
                        <input type="number" id="track-pintores" placeholder="0" min="0" value="0">
                    </div>
                    <div>
                        <label>Horas/dia</label>
                        <input type="number" id="track-pintores-horas" placeholder="8" min="0" step="0.5" value="8">
                    </div>
                </div>
            </div>

            <div class="worker-input">
                <label>‚ö° Eletricistas</label>
                <div class="worker-inputs-row">
                    <div>
                        <label>Quantidade</label>
                        <input type="number" id="track-eletricistas" placeholder="0" min="0" value="0">
                    </div>
                    <div>
                        <label>Horas/dia</label>
                        <input type="number" id="track-eletricistas-horas" placeholder="8" min="0" step="0.5" value="8">
                    </div>
                </div>
            </div>

            <div class="worker-input">
                <label>üîß Encanadores</label>
                <div class="worker-inputs-row">
                    <div>
                        <label>Quantidade</label>
                        <input type="number" id="track-encanadores" placeholder="0" min="0" value="0">
                    </div>
                    <div>
                        <label>Horas/dia</label>
                        <input type="number" id="track-encanadores-horas" placeholder="8" min="0" step="0.5" value="8">
                    </div>
                </div>
            </div>

            <div class="form-group">
                <label>Prazo Total Estimado (dias √∫teis)</label>
                <input type="number" id="total-days" placeholder="Ex: 15" min="1">
                <div class="info-box">üí° Ser√° calculado automaticamente com base nos servi√ßos e equipe</div>
            </div>

            <button class="btn btn-primary" onclick="initTracking()" style="width: 100%; margin-top: 20px;">
                Iniciar Acompanhamento
            </button>

            <div id="tracking-content" class="hidden">
                <h3 style="margin-top: 30px;">üìà Progresso da Obra</h3>
                
                <div class="progress-bar">
                    <div class="progress-fill" id="progress-fill" style="width: 0%;">0%</div>
                </div>

                <div style="text-align: center; font-size: 1.2em; margin: 20px 0;">
                    <strong>Dias Trabalhados:</strong> <span id="days-worked">0</span> de <span id="total-days-display">0</span>
                </div>

                <div id="tracking-items"></div>
            </div>
        </div>

        <!-- ESTRAT√âGIAS SUSTENT√ÅVEIS -->
        <div id="sustainability" class="screen">
            <button class="btn-back" onclick="showScreen('home')">‚Üê Voltar</button>
            <h2>üå± Estrat√©gias Sustent√°veis</h2>
            
            <div class="info-box">
                <strong>üíö Transforme sua reforma em um projeto sustent√°vel!</strong><br>
                Economize dinheiro, reduza impacto ambiental e valorize seu im√≥vel!
            </div>

            <div class="sustainability-card">
                <h4>üíß Reaproveitamento de √Ågua</h4>
                <p>Sistemas que captam √°gua da chuva ou reutilizam √°gua cinza (de pias, chuveiros) para uso em vasos sanit√°rios, limpeza e irriga√ß√£o.</p>
                
                <div class="sustainability-option">
                    <strong>Sistema B√°sico (R$ 800 - R$ 1.200)</strong>
                    <p>‚Ä¢ Capta√ß√£o de √°gua da pia da cozinha<br>
                    ‚Ä¢ Reservat√≥rio de 100L<br>
                    ‚Ä¢ Filtro b√°sico<br>
                    ‚Ä¢ Economia: at√© 15% na conta de √°gua</p>
                </div>

                <div class="sustainability-option">
                    <strong>Sistema Intermedi√°rio (R$ 1.500 - R$ 2.500)</strong>
                    <p>‚Ä¢ Capta√ß√£o de √°gua do chuveiro<br>
                    ‚Ä¢ Reservat√≥rio de 200L<br>
                    ‚Ä¢ Sistema de filtragem completo<br>
                    ‚Ä¢ Economia: at√© 30% na conta de √°gua</p>
                </div>

                <div class="sustainability-option">
                    <strong>Sistema Completo (R$ 2.500 - R$ 5.000)</strong>
                    <p>‚Ä¢ Capta√ß√£o de chuva + √°guas cinzas<br>
                    ‚Ä¢ Reservat√≥rio de 500L<br>
                    ‚Ä¢ Tratamento UV<br>
                    ‚Ä¢ Bombeamento autom√°tico<br>
                    ‚Ä¢ Economia: at√© 50% na conta de √°gua</p>
                </div>

                <div style="background: #fff3cd; padding: 15px; border-radius: 8px; margin-top: 15px;">
                    <strong>ü§î Quer implementar na sua reforma?</strong><br>
                    Marque a op√ß√£o "Reaproveitamento de √Ågua" ao fazer seu or√ßamento!
                </div>
            </div>

            <div class="sustainability-card">
                <h4>‚òÄÔ∏è Energia Solar</h4>
                <p>Pain√©is fotovoltaicos que convertem luz solar em energia el√©trica, reduzindo drasticamente sua conta de luz.</p>
                
                <div class="sustainability-option">
                    <strong>Kit Residencial Pequeno (R$ 12.000 - R$ 18.000)</strong>
                    <p>‚Ä¢ 4-6 pain√©is (1,6 kWp)<br>
                    ‚Ä¢ Economia: at√© 50% na conta de luz<br>
                    ‚Ä¢ Retorno do investimento: 4-6 anos<br>
                    ‚Ä¢ Ideal para: casas at√© 80m¬≤</p>
                </div>

                <div class="sustainability-option">
                    <strong>Kit Residencial M√©dio (R$ 18.000 - R$ 28.000)</strong>
                    <p>‚Ä¢ 8-12 pain√©is (3,2 kWp)<br>
                    ‚Ä¢ Economia: at√© 75% na conta de luz<br>
                    ‚Ä¢ Retorno do investimento: 5-7 anos<br>
                    ‚Ä¢ Ideal para: casas de 80-150m¬≤</p>
                </div>

                <div class="sustainability-option">
                    <strong>Kit Residencial Grande (R$ 28.000 - R$ 45.000)</strong>
                    <p>‚Ä¢ 14-20 pain√©is (5+ kWp)<br>
                    ‚Ä¢ Economia: at√© 95% na conta de luz<br>
                    ‚Ä¢ Retorno do investimento: 6-8 anos<br>
                    ‚Ä¢ Ideal para: casas acima de 150m¬≤</p>
                </div>

                <div style="background: #fff3cd; padding: 15px; border-radius: 8px; margin-top: 15px;">
                    <strong>üí° Dica:</strong> Em reformas maiores, aproveite para planejar a estrutura do telhado para receber pain√©is solares no futuro!
                </div>
            </div>

            <div class="sustainability-card">
                <h4>‚ôªÔ∏è Materiais Reciclados e Sustent√°veis</h4>
                <p>Materiais de constru√ß√£o ecol√≥gicos que reduzem impacto ambiental sem perder qualidade.</p>
                
                <div class="sustainability-option">
                    <strong>Pisos Sustent√°veis</strong>
                    <p>‚Ä¢ Bambu: renov√°vel, dur√°vel, bonito (R$ 120/m¬≤)<br>
                    ‚Ä¢ Porcelanato Eco: 30% material reciclado (R$ 105/m¬≤)<br>
                    ‚Ä¢ Laminado Ecol√≥gico: madeira certificada (R$ 95/m¬≤)</p>
                </div>

                <div class="sustainability-option">
                    <strong>Tintas Ecol√≥gicas</strong>
                    <p>‚Ä¢ Sem VOC (compostos vol√°teis)<br>
                    ‚Ä¢ Base √°gua<br>
                    ‚Ä¢ N√£o t√≥xicas<br>
                    ‚Ä¢ Pre√ßo: +15% sobre tinta convencional</p>
                </div>

                <div class="sustainability-option">
                    <strong>Lou√ßas Economizadoras</strong>
                    <p>‚Ä¢ Vaso sanit√°rio duplo fluxo: economiza 40% de √°gua<br>
                    ‚Ä¢ Torneiras aeradoras: reduzem vaz√£o em 50%<br>
                    ‚Ä¢ Chuveiros eco: 30% menos √°gua<br>
                    ‚Ä¢ Pre√ßo: similar √†s convencionais</p>
                </div>
            </div>

            <div class="sustainability-card">
                <h4>üå°Ô∏è Isolamento T√©rmico</h4>
                <p>Reduz necessidade de ar condicionado e aquecimento, economizando energia.</p>
                
                <div class="sustainability-option">
                    <strong>Telhado Verde (R$ 150-300/m¬≤)</strong>
                    <p>‚Ä¢ Camada de vegeta√ß√£o no telhado<br>
                    ‚Ä¢ Reduz temperatura interna em at√© 5¬∞C<br>
                    ‚Ä¢ Ret√©m √°gua da chuva<br>
                    ‚Ä¢ Aumenta vida √∫til do telhado</p>
                </div>

                <div class="sustainability-option">
                    <strong>Mantas T√©rmicas (R$ 30-80/m¬≤)</strong>
                    <p>‚Ä¢ Instaladas sob o telhado<br>
                    ‚Ä¢ Bloqueiam at√© 95% do calor<br>
                    ‚Ä¢ F√°cil instala√ß√£o<br>
                    ‚Ä¢ Economia de 30% em ar condicionado</p>
                </div>
            </div>

            <div class="sustainability-card">
                <h4>üí® Ventila√ß√£o Natural</h4>
                <p>Projeto inteligente que reduz necessidade de ar condicionado.</p>
                
                <div class="sustainability-option">
                    <strong>Estrat√©gias</strong>
                    <p>‚Ä¢ Posicionamento estrat√©gico de janelas<br>
                    ‚Ä¢ Uso de venezianas e cobog√≥s<br>
                    ‚Ä¢ Cria√ß√£o de corredores de vento<br>
                    ‚Ä¢ P√©-direito alto para circula√ß√£o de ar</p>
                </div>
            </div>

            <div style="background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%); padding: 25px; border-radius: 15px; margin-top: 30px; text-align: center;">
                <h3 style="color: #2e7d32; margin-bottom: 15px;">üíö Impacto Ambiental Positivo</h3>
                <p style="font-size: 1.1em; color: #1b5e20;">
                    Ao escolher materiais e sistemas sustent√°veis, voc√™:<br>
                    ‚úÖ Reduz emiss√µes de CO‚ÇÇ<br>
                    ‚úÖ Economiza recursos naturais<br>
                    ‚úÖ Diminui desperd√≠cio de √°gua e energia<br>
                    ‚úÖ Valoriza seu im√≥vel em at√© 20%<br>
                    ‚úÖ Economiza dinheiro a longo prazo
                </p>
            </div>
        </div>
    </div>

    <script>
        let currentState = 1.0; // ES como base
        let savedBudgets = [];
        let trackingSteps = [];
        let wallCounters = {coz: 0, ban: 0};

        // Carregar or√ßamentos salvos do localStorage ao iniciar
        function loadFromStorage() {
            const stored = localStorage.getItem('obra-inteligente-budgets');
            if (stored) {
                try {
                    savedBudgets = JSON.parse(stored);
                } catch (e) {
                    console.error('Erro ao carregar or√ßamentos salvos:', e);
                    savedBudgets = [];
                }
            }
        }

        // Salvar or√ßamentos no localStorage
        function saveToStorage() {
            try {
                localStorage.setItem('obra-inteligente-budgets', JSON.stringify(savedBudgets));
            } catch (e) {
                console.error('Erro ao salvar or√ßamentos:', e);
            }
        }

        // Carregar dados ao iniciar
        loadFromStorage();

        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById(screenId).classList.add('active');
            
            if (screenId === 'tracking') {
                loadBudgetSelectList();
            }
        }

        function updateState() {
            const stateSelect = document.getElementById('state') || document.getElementById('rev-state');
            currentState = parseFloat(stateSelect.value);
        }

        function showReformForm() {
            const type = document.getElementById('reform-type').value;
            ['cozinha', 'banheiro', 'casa', 'quarto', 'sala'].forEach(t => {
                document.getElementById('form-' + t).classList.add('hidden');
            });
            if (type) {
                document.getElementById('form-' + type).classList.remove('hidden');
                if (type === 'cozinha' || type === 'banheiro') {
                    addWall(type.substring(0, 3));
                }
            }
        }

        // Handlers para mostrar/ocultar campos customizados
        ['coz', 'ban', 'qua', 'sal'].forEach(prefix => {
            ['piso', 'pintura', 'bancada'].forEach(field => {
                const selectId = `${prefix}-${field}-tipo`;
                const customId = `${prefix}-${field}-custom`;
                if (document.getElementById(selectId)) {
                    document.getElementById(selectId).addEventListener('change', function() {
                        const custom = document.getElementById(customId);
                        if (custom) {
                            if (this.value === 'custom') {
                                custom.classList.remove('hidden');
                            } else {
                                custom.classList.add('hidden');
                            }
                        }
                    });
                }
            });
        });

        // Handlers para campos "Outro"
        ['coz-piso', 'ban-piso', 'qua-piso', 'sal-piso', 'coz-pia', 'ban-loucas', 'ban-boxe'].forEach(id => {
            const select = document.getElementById(id);
            const custom = document.getElementById(id + '-custom');
            if (select && custom) {
                select.addEventListener('change', function() {
                    if (this.value === 'custom') {
                        custom.classList.remove('hidden');
                    } else {
                        custom.classList.add('hidden');
                    }
                });
            }
        });

        // Handlers para checkboxes
        const checkboxHandlers = {
            'coz-bancada': 'coz-bancada-options',
            'coz-pia': 'coz-pia-options',
            'coz-reuso': 'coz-reuso-options',
            'coz-demolir': 'coz-demolir-options',
            'coz-pintura': 'coz-pintura-options',
            'ban-loucas': 'ban-loucas-options',
            'ban-boxe': 'ban-boxe-options',
            'ban-banheira': 'ban-banheira-options',
            'ban-reuso': 'ban-reuso-options',
            'ban-demolir': 'ban-demolir-options',
            'ban-pintura': 'ban-pintura-options',
            'casa-reuso': 'casa-reuso-options',
            'casa-solar': 'casa-solar-options',
            'qua-demolir': 'qua-demolir-options',
            'sal-demolir': 'sal-demolir-options',
            'rev-cozinha': 'rev-cozinha-area-div',
            'rev-banheiro': 'rev-banheiro-area-div',
            'rev-quarto': 'rev-quarto-area-div',
            'rev-sala': 'rev-sala-area-div'
        };

        Object.keys(checkboxHandlers).forEach(checkboxId => {
            const checkbox = document.getElementById(checkboxId);
            const targetDiv = document.getElementById(checkboxHandlers[checkboxId]);
            if (checkbox && targetDiv) {
                checkbox.addEventListener('change', function() {
                    if (this.checked) {
                        targetDiv.classList.remove('hidden');
                    } else {
                        targetDiv.classList.add('hidden');
                    }
                });
            }
        });

        // Handlers especiais para pintura de quarto e sala
        function setupPaintingHandlers(prefix) {
            const pintarParedes = document.getElementById(prefix + '-pintar-paredes');
            const pintarTeto = document.getElementById(prefix + '-pintar-teto');
            const calcDiv = document.getElementById(prefix + '-pintura-calc');
            const optionsDiv = document.getElementById(prefix + '-pintura-options');
            const areaInput = document.getElementById(prefix + '-area');
            const pinturaArea = document.getElementById(prefix + '-pintura-area');
            const pinturaAuto = document.getElementById(prefix + '-pintura-auto');

            function updatePaintingArea() {
                const area = parseFloat(areaInput.value) || 0;
                const paredes = pintarParedes.checked;
                const teto = pintarTeto.checked;
                
                let multiplier = 0;
                if (paredes && teto) {
                    multiplier = 3.8; // Paredes + teto
                } else if (paredes) {
                    multiplier = 2.8; // S√≥ paredes (aproximado)
                } else if (teto) {
                    multiplier = 1.0; // S√≥ teto
                }

                const calculatedArea = area * multiplier;
                pinturaAuto.textContent = calculatedArea.toFixed(1);
                pinturaArea.value = calculatedArea.toFixed(1);

                if (paredes || teto) {
                    calcDiv.classList.remove('hidden');
                    optionsDiv.classList.remove('hidden');
                } else {
                    calcDiv.classList.add('hidden');
                    optionsDiv.classList.add('hidden');
                }
            }

            if (pintarParedes) pintarParedes.addEventListener('change', updatePaintingArea);
            if (pintarTeto) pintarTeto.addEventListener('change', updatePaintingArea);
            if (areaInput) areaInput.addEventListener('input', updatePaintingArea);
        }

        setupPaintingHandlers('qua');
        setupPaintingHandlers('sal');

        function addWall(prefix) {
            wallCounters[prefix]++;
            const wallsDiv = document.getElementById(prefix + '-walls');
            const wallDiv = document.createElement('div');
            wallDiv.className = 'wall-item';
            wallDiv.id = `${prefix}-wall-${wallCounters[prefix]}`;
            wallDiv.innerHTML = `
                <button class="btn-remove-wall" onclick="removeWall('${prefix}', ${wallCounters[prefix]})">Remover</button>
                <strong>Parede ${wallCounters[prefix]}</strong>
                <div style="clear: both; margin-top: 10px;">
                    <label>Largura (m)</label>
                    <input type="number" id="${prefix}-wall-${wallCounters[prefix]}-width" placeholder="Ex: 3" step="0.1">
                </div>
                <div style="margin-top: 10px;">
                    <label>Altura (m)</label>
                    <input type="number" id="${prefix}-wall-${wallCounters[prefix]}-height" placeholder="Ex: 1.5" step="0.1">
                </div>
                <div style="margin-top: 10px;">
                    <label>Tipo de Azulejo/Revestimento</label>
                    <select id="${prefix}-wall-${wallCounters[prefix]}-type">
                        <option value="75">Azulejo Eliane - R$ 75/m¬≤</option>
                        <option value="85">Azulejo Portobello - R$ 85/m¬≤</option>
                        <option value="95">Revestimento Incepa Green üå± - R$ 95/m¬≤</option>
                        <option value="custom">üí∞ Outro (digitar valor)</option>
                    </select>
                    <input type="number" id="${prefix}-wall-${wallCounters[prefix]}-custom" class="hidden" placeholder="Valor por m¬≤" step="0.01">
                </div>
            `;
            wallsDiv.appendChild(wallDiv);

            // Handler para "Outro"
            document.getElementById(`${prefix}-wall-${wallCounters[prefix]}-type`).addEventListener('change', function() {
                const custom = document.getElementById(`${prefix}-wall-${wallCounters[prefix]}-custom`);
                if (this.value === 'custom') {
                    custom.classList.remove('hidden');
                } else {
                    custom.classList.add('hidden');
                }
            });
        }

        function removeWall(prefix, id) {
            const wallDiv = document.getElementById(`${prefix}-wall-${id}`);
            if (wallDiv) wallDiv.remove();
        }

        function getWallsCost(prefix) {
            let total = 0;
            for (let i = 1; i <= wallCounters[prefix]; i++) {
                const wallDiv = document.getElementById(`${prefix}-wall-${i}`);
                if (!wallDiv) continue;

                const width = parseFloat(document.getElementById(`${prefix}-wall-${i}-width`).value) || 0;
                const height = parseFloat(document.getElementById(`${prefix}-wall-${i}-height`).value) || 0;
                const typeSelect = document.getElementById(`${prefix}-wall-${i}-type`);
                let price = parseFloat(typeSelect.value);
                
                if (typeSelect.value === 'custom') {
                    price = parseFloat(document.getElementById(`${prefix}-wall-${i}-custom`).value) || 0;
                }

                total += width * height * price * currentState;
            }
            return total;
        }

        function getValue(id, defaultValue = 0) {
            const el = document.getElementById(id);
            if (!el) return defaultValue;
            const val = parseFloat(el.value);
            return isNaN(val) ? defaultValue : val;
        }

        function getSelectValue(id) {
            const select = document.getElementById(id);
            if (!select) return 0;
            if (select.value === 'custom') {
                return getValue(id + '-custom', 0);
            }
            return parseFloat(select.value) || 0;
        }

        function isChecked(id) {
            const el = document.getElementById(id);
            return el ? el.checked : false;
        }

        function formatCurrency(value) {
            return value.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
        }

        function calculateBudget(type) {
            let total = 0;
            let details = [];
            let ecoItems = [];
            
            // Pegar √°rea baseado no tipo
            let area;
            if (type === 'casa') {
                area = getValue('casa-area');
            } else {
                area = getValue(type.substring(0, 3) + '-area');
            }
            
            if (!area) {
                alert('Informe a √°rea do ambiente!');
                return;
            }

            // Piso (n√£o para casa, que tem l√≥gica pr√≥pria)
            if (type !== 'casa') {
                const pisoPrice = getSelectValue(type.substring(0, 3) + '-piso');
                const pisoCost = area * pisoPrice * currentState;
                total += pisoCost;
                details.push({ name: 'Piso', cost: pisoCost });
                if (pisoPrice >= 105) ecoItems.push('Piso Ecol√≥gico');
            }

            // L√≥gica espec√≠fica por tipo
            if (type === 'cozinha') {
                // Revestimento
                const wallsCost = getWallsCost('coz');
                if (wallsCost > 0) {
                    total += wallsCost;
                    details.push({ name: 'Revestimento Paredes', cost: wallsCost });
                }

                // Pintura
                if (isChecked('coz-pintura')) {
                    const pinturaArea = getValue('coz-pintura-area');
                    const pinturaPrice = getSelectValue('coz-pintura-tipo');
                    let pinturaCost = pinturaArea * pinturaPrice * currentState;
                    
                    // Massa corrida
                    if (isChecked('coz-pintura-preparo')) {
                        const preparoCost = pinturaArea * 15 * currentState;
                        pinturaCost += preparoCost;
                        details.push({ name: 'Lixamento e Massa Corrida', cost: preparoCost });
                    }
                    
                    total += pinturaCost;
                    details.push({ name: 'Pintura', cost: pinturaCost });
                    if (pinturaPrice >= 35) ecoItems.push('Tinta Ecol√≥gica');
                }

                // Bancada
                if (isChecked('coz-bancada')) {
                    const bancadaComp = getValue('coz-bancada-comp');
                    const bancadaPrice = getSelectValue('coz-bancada-tipo');
                    const bancadaCost = bancadaComp * bancadaPrice * currentState;
                    total += bancadaCost;
                    details.push({ name: 'Bancada', cost: bancadaCost });
                    if (bancadaPrice >= 600) ecoItems.push('Bancada Sustent√°vel');
                }

                // Pia
                if (isChecked('coz-pia')) {
                    const piaCost = getSelectValue('coz-pia-tipo') * currentState;
                    total += piaCost;
                    details.push({ name: 'Pia', cost: piaCost });
                }

                // El√©trica
                if (isChecked('coz-eletrica')) {
                    const eletricaCost = area * 80 * currentState;
                    total += eletricaCost;
                    details.push({ name: 'El√©trica', cost: eletricaCost });
                }

                // Hidr√°ulica
                if (isChecked('coz-hidraulica')) {
                    const hidraulicaCost = area * 100 * currentState;
                    total += hidraulicaCost;
                    details.push({ name: 'Hidr√°ulica', cost: hidraulicaCost });
                }

                // Sistema de Re√∫so
                if (isChecked('coz-reuso')) {
                    const reusoSelect = document.getElementById('coz-reuso-tipo');
                    const reusoCost = parseFloat(reusoSelect.value) * currentState;
                    total += reusoCost;
                    details.push({ name: 'Sistema Re√∫so √Ågua', cost: reusoCost });
                    ecoItems.push('Reaproveitamento de √Ågua');
                }

                // Demoli√ß√£o
                if (isChecked('coz-demolir')) {
                    const demolirArea = getValue('coz-demolir-area');
                    const demolirCost = demolirArea * 150 * currentState;
                    total += demolirCost;
                    details.push({ name: 'Demoli√ß√£o', cost: demolirCost });
                }

            } else if (type === 'banheiro') {
                // Revestimento
                const wallsCost = getWallsCost('ban');
                if (wallsCost > 0) {
                    total += wallsCost;
                    details.push({ name: 'Revestimento Paredes', cost: wallsCost });
                }

                // Pintura
                if (isChecked('ban-pintura')) {
                    const pinturaArea = getValue('ban-pintura-area');
                    const pinturaPrice = getSelectValue('ban-pintura-tipo');
                    let pinturaCost = pinturaArea * pinturaPrice * currentState;
                    
                    // Massa corrida
                    if (isChecked('ban-pintura-preparo')) {
                        const preparoCost = pinturaArea * 15 * currentState;
                        pinturaCost += preparoCost;
                        details.push({ name: 'Lixamento e Massa Corrida', cost: preparoCost });
                    }
                    
                    total += pinturaCost;
                    details.push({ name: 'Pintura Anti-Mofo', cost: pinturaCost });
                    if (pinturaPrice >= 40) ecoItems.push('Tinta Anti-Mofo Eco');
                }

                // Lou√ßas
                if (isChecked('ban-loucas')) {
                    const loucasCost = getSelectValue('ban-loucas-tipo') * currentState;
                    total += loucasCost;
                    details.push({ name: 'Kit Lou√ßas', cost: loucasCost });
                    if (loucasCost >= 2200) ecoItems.push('Lou√ßas Economizadoras');

                    // Banheira
                    if (isChecked('ban-banheira')) {
                        const banheiraSelect = document.getElementById('ban-banheira-tipo');
                        const banheiraCost = parseFloat(banheiraSelect.value) * currentState;
                        total += banheiraCost;
                        details.push({ name: 'Banheira', cost: banheiraCost });
                    }
                }

                // Box
                if (isChecked('ban-boxe')) {
                    const boxeCost = getSelectValue('ban-boxe-tipo') * currentState;
                    total += boxeCost;
                    details.push({ name: 'Box', cost: boxeCost });
                }

                // El√©trica
                if (isChecked('ban-eletrica')) {
                    const eletricaCost = area * 80 * currentState;
                    total += eletricaCost;
                    details.push({ name: 'El√©trica', cost: eletricaCost });
                }

                // Hidr√°ulica
                if (isChecked('ban-hidraulica')) {
                    const hidraulicaCost = area * 120 * currentState;
                    total += hidraulicaCost;
                    details.push({ name: 'Hidr√°ulica', cost: hidraulicaCost });
                }

                // Sistema de Re√∫so
                if (isChecked('ban-reuso')) {
                    const reusoSelect = document.getElementById('ban-reuso-tipo');
                    const reusoCost = parseFloat(reusoSelect.value) * currentState;
                    total += reusoCost;
                    details.push({ name: 'Sistema Re√∫so √Ågua Chuveiro', cost: reusoCost });
                    ecoItems.push('Reaproveitamento de √Ågua do Chuveiro');
                }

                // Demoli√ß√£o
                if (isChecked('ban-demolir')) {
                    const demolirArea = getValue('ban-demolir-area');
                    const demolirCost = demolirArea * 150 * currentState;
                    total += demolirCost;
                    details.push({ name: 'Demoli√ß√£o', cost: demolirCost });
                }

            } else if (type === 'quarto' || type === 'sala') {
                const prefix = type.substring(0, 3);
                
                // Pintura - nova l√≥gica
                const pintarParedes = isChecked(prefix + '-pintar-paredes');
                const pintarTeto = isChecked(prefix + '-pintar-teto');
                
                if (pintarParedes || pintarTeto) {
                    const pinturaArea = getValue(prefix + '-pintura-area');
                    const pinturaPrice = getSelectValue(prefix + '-pintura-tipo');
                    let pinturaCost = pinturaArea * pinturaPrice * currentState;
                    
                    // Massa corrida
                    if (isChecked(prefix + '-pintura-preparo')) {
                        const preparoCost = pinturaArea * 15 * currentState;
                        pinturaCost += preparoCost;
                        details.push({ name: 'Lixamento e Massa Corrida', cost: preparoCost });
                    }
                    
                    total += pinturaCost;
                    details.push({ name: 'Pintura', cost: pinturaCost });
                    if (pinturaPrice >= 35) ecoItems.push('Tinta Ecol√≥gica');
                }

                // El√©trica
                if (isChecked(prefix + '-eletrica')) {
                    const eletricaCost = area * 70 * currentState;
                    total += eletricaCost;
                    details.push({ name: 'El√©trica', cost: eletricaCost });
                }

                // Demoli√ß√£o
                if (isChecked(prefix + '-demolir')) {
                    const demolirArea = getValue(prefix + '-demolir-area');
                    const demolirCost = demolirArea * 150 * currentState;
                    total += demolirCost;
                    details.push({ name: 'Demoli√ß√£o', cost: demolirCost });
                }
            } else if (type === 'casa') {
                // Casa Pequena
                
                // Funda√ß√£o
                const fundacaoPrice = parseFloat(document.getElementById('casa-fundacao').value);
                const fundacaoCost = area * fundacaoPrice * currentState;
                total += fundacaoCost;
                details.push({ name: 'Funda√ß√£o', cost: fundacaoCost });

                // Alvenaria
                const alvenariaPrice = parseFloat(document.getElementById('casa-alvenaria').value);
                const alvenariaCost = area * alvenariaPrice * currentState;
                total += alvenariaCost;
                details.push({ name: 'Alvenaria', cost: alvenariaCost });
                if (alvenariaPrice >= 420) ecoItems.push('Tijolo Ecol√≥gico');

                // Telhado
                const telhadoPrice = parseFloat(document.getElementById('casa-telhado').value);
                const telhadoCost = area * telhadoPrice * currentState;
                total += telhadoCost;
                details.push({ name: 'Cobertura/Telhado', cost: telhadoCost });
                if (telhadoPrice >= 280) ecoItems.push('Telha Ecol√≥gica');

                // Portas
                const portasQtd = getValue('casa-portas-qtd');
                const portasPrice = parseFloat(document.getElementById('casa-portas').value);
                const portasCost = portasQtd * portasPrice * currentState;
                total += portasCost;
                details.push({ name: `Portas (${portasQtd} un)`, cost: portasCost });

                // Janelas
                const janelasQtd = getValue('casa-janelas-qtd');
                const janelasPrice = parseFloat(document.getElementById('casa-janelas').value);
                const janelasCost = janelasQtd * janelasPrice * currentState;
                total += janelasCost;
                details.push({ name: `Janelas (${janelasQtd} un)`, cost: janelasCost });
                if (janelasPrice >= 600) ecoItems.push('Janelas PVC Eco');

                // Piso
                const casaPisoPrice = parseFloat(document.getElementById('casa-piso').value);
                const casaPisoCost = area * casaPisoPrice * currentState;
                total += casaPisoCost;
                details.push({ name: 'Piso', cost: casaPisoCost });
                if (casaPisoPrice >= 105) ecoItems.push('Piso Sustent√°vel');

                // Pintura
                const casaPinturaPrice = parseFloat(document.getElementById('casa-pintura').value);
                let casaPinturaCost = (area * 3.8) * casaPinturaPrice * currentState;
                
                // Massa corrida
                if (isChecked('casa-pintura-preparo')) {
                    const preparoCost = (area * 3.8) * 15 * currentState;
                    casaPinturaCost += preparoCost;
                    details.push({ name: 'Lixamento e Massa Corrida', cost: preparoCost });
                }
                
                total += casaPinturaCost;
                details.push({ name: 'Pintura', cost: casaPinturaCost });
                if (casaPinturaPrice >= 35) ecoItems.push('Tinta Ecol√≥gica');

                // Instala√ß√µes
                if (isChecked('casa-eletrica')) {
                    const eletricaCost = area * 90 * currentState;
                    total += eletricaCost;
                    details.push({ name: 'Instala√ß√£o El√©trica', cost: eletricaCost });
                }

                if (isChecked('casa-hidraulica')) {
                    const hidraulicaCost = area * 110 * currentState;
                    total += hidraulicaCost;
                    details.push({ name: 'Instala√ß√£o Hidr√°ulica', cost: hidraulicaCost });
                }

                // Sistema de Re√∫so
                if (isChecked('casa-reuso')) {
                    const reusoSelect = document.getElementById('casa-reuso-tipo');
                    const reusoCost = parseFloat(reusoSelect.value) * currentState;
                    total += reusoCost;
                    details.push({ name: 'Sistema Re√∫so de √Ågua', cost: reusoCost });
                    ecoItems.push('Reaproveitamento de √Ågua');
                }

                // Prepara√ß√£o Solar
                if (isChecked('casa-solar')) {
                    const solarCost = 2000 * currentState;
                    total += solarCost;
                    details.push({ name: 'Prepara√ß√£o para Energia Solar', cost: solarCost });
                    ecoItems.push('Prepara√ß√£o Solar');
                }
            }

            // M√£o de Obra (50%)
            const maoDeObra = total * 0.50;
            details.push({ name: 'M√£o de Obra (50%)', cost: maoDeObra });
            total += maoDeObra;

            // Conting√™ncias
            const imprevistos = total * 0.125;
            const perdaMaterial = total * 0.05;
            const atrasoMO = total * 0.10;

            const baseTotal = total;
            const realisticTotal = total + imprevistos + perdaMaterial + atrasoMO;

            // Cronograma
            let workDays;
            if (type === 'cozinha' || type === 'banheiro') {
                workDays = Math.ceil(area * 2);
            } else if (type === 'casa') {
                workDays = Math.ceil(area * 4); // Casa completa leva mais tempo
            } else {
                workDays = Math.ceil(area * 1.5);
            }

            const optWorkDays = Math.ceil(workDays * 0.85);
            const delayWorkDays = Math.ceil(workDays * 1.25);

            // Calcular HH e equipe
            const totalHH = workDays * 8;
            let workers = '1 pedreiro + 1 ajudante';
            if (type === 'casa') {
                workers = '2 pedreiros + 2 ajudantes + 1 eletricista + 1 encanador';
            } else {
                if (isChecked(type.substring(0, 3) + '-eletrica')) workers += ' + 1 eletricista';
                if (isChecked(type.substring(0, 3) + '-hidraulica')) workers += ' + 1 encanador';
            }

            // Exibir resultado
            let html = '<div class="result">';
            html += `<h2>üí∞ Or√ßamento: ${type.charAt(0).toUpperCase() + type.slice(1)}</h2>`;

            // Detalhamento
            html += '<div class="breakdown"><h3>üìã Detalhamento</h3>';
            details.forEach(item => {
                html += `<div class="breakdown-item"><span>${item.name}</span><span>R$ ${formatCurrency(item.cost)}</span></div>`;
            });
            html += `<div class="breakdown-item"><span>SUBTOTAL</span><span>R$ ${formatCurrency(baseTotal)}</span></div>`;
            html += '</div>';

            // Conting√™ncias
            html += '<div class="contingency-box">';
            html += '<h3>‚ö†Ô∏è Conting√™ncias Recomendadas</h3>';
            html += `<div class="contingency-item"><span>Imprevistos (12,5%)</span><span style="color: #66bb6a; font-weight: bold;">R$ ${formatCurrency(imprevistos)}</span></div>`;
            html += `<div class="contingency-item"><span>Perda Material (5%)</span><span style="color: #66bb6a; font-weight: bold;">R$ ${formatCurrency(perdaMaterial)}</span></div>`;
            html += `<div class="contingency-item"><span>Atrasos/Falta MO (10%)</span><span style="color: #66bb6a; font-weight: bold;">R$ ${formatCurrency(atrasoMO)}</span></div>`;
            html += '</div>';

            // Or√ßamentos
            html += '<div class="budget-card budget-realistic">';
            html += '<h3>üíº Or√ßamento Realista</h3>';
            html += `<div class="total-price" style="color: white;">R$ ${formatCurrency(realisticTotal)}</div>`;
            html += '</div>';

            html += '<div class="budget-card budget-safe">';
            html += '<h3>üìä Or√ßamento Seguro</h3>';
            html += `<div class="total-price" style="color: white;">R$ ${formatCurrency(realisticTotal * 1.15)}</div>`;
            html += '<small style="color: white;">(Realista + 15% margem de seguran√ßa)</small>';
            html += '</div>';

            // Cronograma
            html += '<div class="schedule">';
            html += '<h3>üìÖ Cronograma de Execu√ß√£o</h3>';
            html += `<div class="schedule-item"><strong>‚ö° Otimista:</strong> ${optWorkDays} dias √∫teis<br><small>Tudo sai perfeito</small></div>`;
            html += `<div class="schedule-item"><strong>‚úÖ Realista:</strong> ${workDays} dias √∫teis<br><small>Cronograma normal</small></div>`;
            html += `<div class="schedule-item"><strong>‚è∞ Com Atrasos:</strong> ${delayWorkDays} dias √∫teis<br><small>Imprevistos e chuvas</small></div>`;
            html += `<div class="info-box"><strong>Equipe Necess√°ria:</strong> ${workers}<br>`;
            html += `<strong>Total HH:</strong> ${totalHH} homens-hora<br>`;
            html += `üí° Considere aumentar o efetivo ou os turnos caso queira acelerar a obra.</div>`;
            html += '</div>';

            // Impacto Sustent√°vel
            if (ecoItems.length > 0) {
                html += '<div class="eco-impact">';
                html += '<h3>üå± Impacto Sustent√°vel</h3>';
                html += '<p>Parab√©ns! Voc√™ escolheu materiais/sistemas ecol√≥gicos:</p><ul>';
                ecoItems.forEach(item => {
                    html += `<li>‚úÖ ${item}</li>`;
                });
                html += '</ul>';
                html += '<p><strong>Benef√≠cios:</strong> Economia de √°gua/energia, menor impacto ambiental, valoriza√ß√£o do im√≥vel!</p>';
                html += '</div>';
            }

            // Bot√£o Salvar
            html += '<div style="margin-top: 20px;">';
            html += '<input type="text" id="budget-name" placeholder="Nome do or√ßamento (ex: Reforma Cozinha)" style="width: 100%; padding: 15px; border-radius: 10px; border: 2px solid #e0e0e0; margin-bottom: 10px;">';
            html += '<button class="btn btn-primary" onclick="saveBudget(\'' + type + '\', ' + area + ', ' + baseTotal + ', ' + realisticTotal + ', ' + workDays + ', \'' + workers + '\')" style="width: 100%;">üíæ Salvar Or√ßamento</button>';
            html += '</div>';

            html += '</div>';

            document.getElementById('result-container').innerHTML = html;
        }

        function saveBudget(type, area, baseTotal, realisticTotal, workDays, workers) {
            const name = document.getElementById('budget-name').value;
            if (!name) {
                alert('Digite um nome para o or√ßamento!');
                return;
            }

            savedBudgets.push({
                name,
                type,
                area,
                baseTotal,
                realisticTotal,
                workDays,
                workers,
                id: Date.now()
            });
            saveToStorage(); // Salvar no localStorage
            alert('‚úÖ Or√ßamento salvo com sucesso!');
            loadSavedBudgets();
        }

        function loadSavedBudgets() {
            const container = document.getElementById('saved-budgets-list');
            if (savedBudgets.length === 0) {
                container.innerHTML = '';
                return;
            }

            let html = '<h3 style="text-align: left; margin-top: 30px;">üìÇ Or√ßamentos Salvos</h3>';
            savedBudgets.slice(-5).reverse().forEach(budget => {
                html += `
                    <div class="saved-budget-card">
                        <strong>${budget.name}</strong><br>
                        <small>Base: R$ ${formatCurrency(budget.baseTotal)} | Realista: R$ ${formatCurrency(budget.realisticTotal)}</small>
                    </div>
                `;
            });
            container.innerHTML = html;
        }

        function loadBudgetSelectList() {
            const container = document.getElementById('budget-select-list');
            if (savedBudgets.length === 0) {
                container.innerHTML = '<div class="info-box">Nenhum or√ßamento salvo ainda. Crie um or√ßamento primeiro na se√ß√£o "Fazer Or√ßamento"!</div>';
                return;
            }

            let html = '<h3>üìÇ Selecione um Or√ßamento Salvo</h3>';
            savedBudgets.forEach((budget, idx) => {
                html += `
                    <div class="saved-budget-card" onclick="selectBudgetForTracking(${idx})">
                        <strong>${budget.name}</strong><br>
                        <small>${budget.type} ${budget.area}m¬≤ | ${budget.workDays} dias | ${budget.workers}</small>
                    </div>
                `;
            });
            html += '<hr style="margin: 30px 0;"><p><strong>Ou configure manualmente abaixo:</strong></p>';
            container.innerHTML = html;
        }

        function selectBudgetForTracking(idx) {
            const budget = savedBudgets[idx];
            document.getElementById('project-name').value = budget.name;
            document.getElementById('track-type').value = budget.type;
            document.getElementById('track-area').value = budget.area;
            document.getElementById('total-days').value = budget.workDays;

            document.querySelectorAll('.saved-budget-card').forEach((el, i) => {
                el.classList.toggle('selected', i === idx);
            });
        }

        function calculateReverse() {
            const budget = parseFloat(document.getElementById('budget-amount').value);
            if (!budget || budget < 1000) {
                alert('Informe um valor v√°lido (m√≠nimo R$ 1.000)');
                return;
            }

            const rooms = {};
            ['cozinha', 'banheiro', 'quarto', 'sala'].forEach(room => {
                if (document.getElementById('rev-' + room).checked) {
                    const area = parseFloat(document.getElementById('rev-' + room + '-area').value);
                    if (area > 0) rooms[room] = area;
                }
            });

            if (Object.keys(rooms).length === 0) {
                alert('Selecione pelo menos um c√¥modo e informe as √°reas!');
                return;
            }

            const costs = {};
            for (let room in rooms) {
                costs[room] = estimateRoomCost(room, rooms[room]);
            }

            const sorted = Object.entries(costs).sort((a, b) => a[1] - b[1]);

            let html = '<div class="result">';
            html += '<h2>üéØ Sua Melhor Estrat√©gia</h2>';

            sorted.forEach(([room, cost]) => {
                const canAfford = cost <= budget;
                const roomName = {cozinha: 'üç≥ Cozinha', banheiro: 'üöø Banheiro', quarto: 'üõèÔ∏è Quarto', sala: 'üõãÔ∏è Sala'}[room];

                html += '<div class="reverse-card">';
                html += `<h3>${roomName} (${rooms[room]}m¬≤)</h3>`;
                html += `<div class="included">‚úÖ Inclu√≠do: Piso + ${room === 'cozinha' || room === 'banheiro' ? 'Revestimento' : 'Pintura'}</div>`;

                if (room === 'cozinha') {
                    html += `<div class="included">‚úÖ Pia atual: Mantida</div>`;
                    html += `<div class="optional">üí° Para trocar pia: +R$ 800 = R$ ${formatCurrency(cost + 800)}</div>`;
                } else if (room === 'banheiro') {
                    html += `<div class="included">‚úÖ Lou√ßas atuais: Mantidas</div>`;
                    html += `<div class="optional">üí° Para trocar lou√ßas: +R$ 1.200 = R$ ${formatCurrency(cost + 1200)}</div>`;
                }

                html += `<div style="font-size: 1.5em; color: ${canAfford ? '#66bb6a' : '#ef5350'}; font-weight: bold; margin-top: 10px;">R$ ${formatCurrency(cost)} ${canAfford ? '‚úÖ' : '‚ùå'}</div>`;
                html += '</div>';
            });

            let accumulated = 0;
            let sequence = [];
            for (let [room, cost] of sorted) {
                if (accumulated + cost <= budget) {
                    accumulated += cost;
                    sequence.push({room, cost});
                }
            }

            if (sequence.length > 0) {
                html += '<div style="background: #e8f5e9; padding: 20px; border-radius: 10px; border: 2px solid #66bb6a;">';
                html += `<h3>‚úÖ Com R$ ${formatCurrency(budget)}, voc√™ consegue:</h3>`;
                sequence.forEach((item, idx) => {
                    const roomName = {cozinha: 'Cozinha', banheiro: 'Banheiro', quarto: 'Quarto', sala: 'Sala'}[item.room];
                    html += `<div style="margin: 10px 0;">${idx + 1}¬∫ ${roomName} (${rooms[item.room]}m¬≤) - R$ ${formatCurrency(item.cost)}</div>`;
                });
                html += `<div style="font-size: 1.3em; font-weight: bold; margin-top: 15px;">Total: R$ ${formatCurrency(accumulated)}</div>`;
                
                const leftover = budget - accumulated;
                html += `<div style="color: #66bb6a; font-weight: bold; font-size: 1.2em; margin-top: 10px;">Sobra: R$ ${formatCurrency(leftover)}</div>`;
                
                // NOVO: Sugest√µes do que fazer com o dinheiro que sobrou
                if (leftover >= 500) {
                    html += '<div style="background: #fff9c4; padding: 15px; border-radius: 10px; margin-top: 15px; border: 2px solid #ffc107;">';
                    html += '<h4 style="color: #f57c00; margin-bottom: 10px;">üí° Sugest√µes para usar os R$ ' + formatCurrency(leftover) + ' restantes:</h4>';
                    
                    const suggestions = [];
                    if (leftover >= 2000) suggestions.push('Trocar todas as portas (R$ 400-600/unidade)');
                    if (leftover >= 1500) suggestions.push('Instalar ar condicionado (R$ 1.500-3.000)');
                    if (leftover >= 1200) suggestions.push('Arm√°rios planejados para quarto (R$ 1.200-5.000/m¬≤)');
                    if (leftover >= 1000) suggestions.push('Ilumina√ß√£o decorativa LED (R$ 800-1.500)');
                    if (leftover >= 800) suggestions.push('Trocar metais do banheiro (torneiras, chuveiro - R$ 600-1.200)');
                    if (leftover >= 600) suggestions.push('Decora√ß√£o (cortinas, quadros, plantas - R$ 500-1.000)');
                    if (leftover >= 500) suggestions.push('Prateleiras e organizadores (R$ 400-800)');
                    
                    if (suggestions.length > 0) {
                        html += '<ul style="margin-top: 10px;">';
                        suggestions.forEach(s => {
                            html += `<li style="margin: 5px 0; color: #555;">üé® ${s}</li>`;
                        });
                        html += '</ul>';
                    }
                    html += '</div>';
                }
                
                html += '</div>';
            } else {
                html += '<div style="background: #ffebee; padding: 20px; border-radius: 10px; border: 2px solid #ef5350;">';
                html += '<h3>‚ùå Or√ßamento insuficiente</h3>';
                html += '<p>Considere: reduzir √°rea, escolher materiais mais econ√¥micos ou aumentar o or√ßamento.</p>';
                html += '</div>';
            }

            html += '</div>';
            document.getElementById('reverse-result').innerHTML = html;
        }

        function estimateRoomCost(room, area) {
            let cost = 0;
            if (room === 'cozinha' || room === 'banheiro') {
                cost += area * 95 * currentState; // Piso
                cost += (area * 2) * 75 * currentState; // Revestimento estimado
            } else {
                cost += area * 85 * currentState; // Piso
                cost += (area * 3.8) * 25 * currentState; // Pintura
            }
            cost += cost * 0.50; // M√£o de obra
            cost += cost * 0.175; // Conting√™ncias
            return cost;
        }

        function initTracking() {
            const projectName = document.getElementById('project-name').value;
            const type = document.getElementById('track-type').value;
            const area = parseFloat(document.getElementById('track-area').value);
            let totalDays = parseInt(document.getElementById('total-days').value);

            if (!projectName || !type || !area) {
                alert('Preencha todos os campos obrigat√≥rios!');
                return;
            }

            // Calcular dias baseado nos servi√ßos
            const services = [];
            if (isChecked('track-piso')) services.push({name: 'Instala√ß√£o Piso', days: Math.ceil(area * 0.5), progress: 0, notes: '', delayed: false});
            if (isChecked('track-revestimento')) services.push({name: 'Revestimento Paredes', days: Math.ceil(area * 0.4), progress: 0, notes: '', delayed: false});
            if (isChecked('track-pintura')) services.push({name: 'Pintura', days: Math.ceil(area * 0.3), progress: 0, notes: '', delayed: false});
            if (isChecked('track-eletrica')) services.push({name: 'Instala√ß√£o El√©trica', days: Math.ceil(area * 0.4), progress: 0, notes: '', delayed: false});
            if (isChecked('track-hidraulica')) services.push({name: 'Instala√ß√£o Hidr√°ulica', days: Math.ceil(area * 0.5), progress: 0, notes: '', delayed: false});
            if (isChecked('track-demolir')) services.push({name: 'Demoli√ß√£o', days: Math.ceil(area * 0.3), progress: 0, notes: '', delayed: false});

            if (services.length === 0) {
                alert('Marque pelo menos um servi√ßo a realizar!');
                return;
            }

            // Calcular equipe
            const pedreiros = parseInt(document.getElementById('track-pedreiros').value) || 0;
            const ajudantes = parseInt(document.getElementById('track-ajudantes').value) || 0;
            const pintores = parseInt(document.getElementById('track-pintores').value) || 0;
            const eletricistas = parseInt(document.getElementById('track-eletricistas').value) || 0;
            const encanadores = parseInt(document.getElementById('track-encanadores').value) || 0;

            const totalWorkers = pedreiros + ajudantes + pintores + eletricistas + encanadores;

            if (totalWorkers === 0) {
                alert('Informe pelo menos um trabalhador contratado!');
                return;
            }

            // Ajustar dias baseado na equipe
            const baseDays = services.reduce((sum, s) => sum + s.days, 0);
            totalDays = totalDays || Math.ceil(baseDays / Math.max(1, totalWorkers * 0.7));

            trackingSteps = services;
            trackingSteps.push({name: 'Acabamentos Finais', days: Math.ceil(totalDays * 0.1), progress: 0, notes: '', delayed: false});

            document.getElementById('tracking-content').classList.remove('hidden');
            document.getElementById('total-days-display').textContent = totalDays;
            updateTracking();
        }

        function updateTracking() {
            const container = document.getElementById('tracking-items');
            container.innerHTML = '';

            let completed = 0;
            let daysWorked = 0;
            let totalProgress = 0;

            trackingSteps.forEach((step, idx) => {
                const div = document.createElement('div');
                const isDelayed = step.delayed || false;
                const progress = step.progress || 0;
                
                div.className = 'tracking-item';
                if (progress === 100) {
                    div.className += ' completed';
                } else if (isDelayed) {
                    div.className += ' delayed';
                }
                
                div.innerHTML = `
                    <div class="tracking-header">
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <input type="checkbox" ${progress === 100 ? 'checked' : ''} 
                                   onchange="toggleStepComplete(${idx})"
                                   style="width: 20px; height: 20px; cursor: pointer;">
                            <strong style="font-size: 1.1em;">${step.name}</strong>
                            <span style="color: #666;">(${step.days} dias)</span>
                        </div>
                        <span style="font-weight: bold; color: ${progress === 100 ? '#66bb6a' : (isDelayed ? '#ff9800' : '#999')};">
                            ${progress === 100 ? '‚úÖ Conclu√≠do' : (isDelayed ? '‚ö†Ô∏è Atrasado' : '‚è≥ Pendente')}
                        </span>
                    </div>
                    
                    <div class="tracking-progress">
                        <span style="color: #999; min-width: 80px;">Progresso:</span>
                        <input type="range" min="0" max="100" value="${progress}" 
                               onchange="updateStepProgress(${idx}, this.value)">
                        <span id="progress-${idx}">${progress}%</span>
                    </div>
                    
                    <div class="delay-checkbox">
                        <input type="checkbox" id="delay-${idx}" ${isDelayed ? 'checked' : ''}
                               onchange="toggleStepDelay(${idx})"
                               style="width: 18px; height: 18px;">
                        <label for="delay-${idx}" style="margin: 0; cursor: pointer;">
                            ‚ö†Ô∏è Esta etapa est√° atrasada
                        </label>
                    </div>
                    
                    <div class="tracking-notes">
                        <label style="font-size: 0.9em; color: #666; font-weight: normal;">
                            üìù Observa√ß√µes (como est√° a obra nesta etapa):
                        </label>
                        <textarea 
                            id="notes-${idx}"
                            placeholder="Ex: Aguardando entrega de material, chuvas atrasaram, tudo conforme planejado..."
                            onchange="updateStepNotes(${idx}, this.value)"
                        >${step.notes || ''}</textarea>
                    </div>
                `;
                container.appendChild(div);

                totalProgress += progress;
                if (progress === 100) {
                    completed++;
                    daysWorked += step.days;
                }
            });

            const overallProgress = Math.round(totalProgress / trackingSteps.length);
            document.getElementById('progress-fill').style.width = overallProgress + '%';
            document.getElementById('progress-fill').textContent = overallProgress + '%';
            document.getElementById('days-worked').textContent = daysWorked;
        }

        function toggleStepComplete(idx) {
            trackingSteps[idx].progress = trackingSteps[idx].progress === 100 ? 0 : 100;
            updateTracking();
        }

        function updateStepProgress(idx, value) {
            trackingSteps[idx].progress = parseInt(value);
            document.getElementById('progress-' + idx).textContent = value + '%';
            
            // Atualiza progresso geral
            let totalProgress = 0;
            trackingSteps.forEach(step => {
                totalProgress += (step.progress || 0);
            });
            const overallProgress = Math.round(totalProgress / trackingSteps.length);
            document.getElementById('progress-fill').style.width = overallProgress + '%';
            document.getElementById('progress-fill').textContent = overallProgress + '%';
        }

        function toggleStepDelay(idx) {
            const checkbox = document.getElementById('delay-' + idx);
            trackingSteps[idx].delayed = checkbox.checked;
            updateTracking();
        }

        function updateStepNotes(idx, notes) {
            trackingSteps[idx].notes = notes;
        }

        function toggleStep(idx) {
            trackingSteps[idx].completed = !trackingSteps[idx].completed;
            updateTracking();
        }

        showScreen('home');
    </script>
</body>
</html>
