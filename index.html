<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Obra Inteligente - Or√ßamento Profissional</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #e8f5e9 0%, #fff9c4 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .header h1 {
            color: #66bb6a;
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        .header p {
            color: #666;
            font-size: 1.1em;
        }
        
        .btn-home {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin: 30px 0;
        }
        
        .btn {
            padding: 40px 20px;
            border: none;
            border-radius: 15px;
            font-size: 1.3em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            color: white;
            text-align: center;
        }
        
        .btn:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #81c784 0%, #66bb6a 100%);
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, #fff59d 0%, #ffee58 100%);
            color: #333;
        }
        
        .btn-tertiary {
            background: linear-gradient(135deg, #90caf9 0%, #64b5f6 100%);
        }
        
        .btn-quaternary {
            background: linear-gradient(135deg, #a5d6a7 0%, #4caf50 100%);
        }
        
        .btn-back {
            background: #f5f5f5;
            color: #666;
            padding: 12px 24px;
            margin-bottom: 20px;
            display: inline-block;
            font-size: 1em;
            border-radius: 8px;
            cursor: pointer;
            border: none;
        }
        
        .form-group {
            margin-bottom: 25px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            color: #555;
            font-weight: 600;
            font-size: 1.05em;
            text-align: left;
        }
        
        input, select {
            width: 100%;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 1em;
            transition: border 0.3s;
        }
        
        input:focus, select:focus {
            outline: none;
            border-color: #66bb6a;
        }
        
        .grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        
        .material-option {
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
            font-size: 0.9em;
            background: white;
        }
        
        .material-option:hover {
            border-color: #66bb6a;
            background: #f1f8e9;
        }
        
        .material-option.selected {
            border-color: #66bb6a;
            background: linear-gradient(135deg, #e8f5e920 0%, #66bb6a20 100%);
        }
        
        .material-option.eco {
            border-color: #4caf50;
            background: #e8f5e9;
        }
        
        .material-option.eco.selected {
            background: linear-gradient(135deg, #4caf5030 0%, #81c78430 100%);
        }
        
        .eco-badge {
            display: inline-block;
            background: #4caf50;
            color: white;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 0.75em;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .wall-item {
            background: #f9f9f9;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 10px;
            border: 1px solid #e0e0e0;
        }
        
        .btn-add-wall {
            background: #66bb6a;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9em;
            margin-top: 10px;
        }
        
        .btn-remove-wall {
            background: #ef5350;
            color: white;
            border: none;
            padding: 5px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.85em;
            float: right;
        }
        
        .result {
            background: linear-gradient(135deg, #f5f5f5 0%, #e8e8e8 100%);
            padding: 30px;
            border-radius: 15px;
            margin-top: 30px;
        }
        
        .result h2 {
            color: #66bb6a;
            margin-bottom: 20px;
            font-size: 1.8em;
        }
        
        .result h3 {
            color: #66bb6a;
            margin: 20px 0 15px 0;
            font-size: 1.3em;
        }
        
        .result-item {
            display: flex;
            justify-content: space-between;
            padding: 12px 15px;
            background: white;
            border-radius: 8px;
            margin-bottom: 8px;
            font-size: 0.95em;
        }
        
        .result-item .label {
            font-weight: 600;
            color: #555;
        }
        
        .result-item .value {
            font-weight: bold;
            color: #66bb6a;
            font-size: 1.1em;
        }
        
        .total {
            background: linear-gradient(135deg, #81c784 0%, #66bb6a 100%);
            color: white !important;
            font-size: 1.3em !important;
            margin-top: 15px;
        }
        
        .total .label, .total .value {
            color: white !important;
        }
        
        .contingency {
            background: #fff9c4;
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
            border-left: 4px solid #fbc02d;
        }
        
        .contingency h3 {
            color: #f57c00 !important;
        }
        
        .timeline {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
        }
        
        .warning {
            background: #ffebee;
            border: 2px solid #ef5350;
            padding: 15px;
            border-radius: 10px;
            margin-top: 15px;
            color: #c62828;
            font-weight: bold;
        }
        
        .info-box {
            background: #e3f2fd;
            border-left: 4px solid #2196f3;
            padding: 12px 15px;
            margin-top: 10px;
            border-radius: 5px;
            font-size: 0.9em;
            color: #1565c0;
            text-align: left;
        }
        
        .btn-action {
            padding: 12px 24px;
            border: none;
            border-radius: 10px;
            font-size: 1em;
            font-weight: bold;
            cursor: pointer;
            margin: 10px 5px;
            transition: all 0.3s;
        }
        
        .btn-save {
            background: #66bb6a;
            color: white;
        }
        
        .btn-print {
            background: #42a5f5;
            color: white;
        }
        
        .btn-action:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        .hidden {
            display: none;
        }
        
        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 10px;
        }
        
        .reverse-room {
            background: white;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 15px;
            border: 2px solid #e0e0e0;
        }
        
        .reverse-card {
            background: white;
            padding: 20px;
            border-radius: 15px;
            border: 2px solid #e0e0e0;
            margin-bottom: 20px;
        }
        
        .reverse-card h3 {
            color: #66bb6a;
            margin-bottom: 10px;
        }
        
        .reverse-card .included {
            color: #4caf50;
            font-size: 0.9em;
            margin: 5px 0;
        }
        
        .reverse-card .optional {
            color: #ff9800;
            font-size: 0.9em;
            margin: 5px 0;
        }
        
        .eco-section {
            background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%);
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
            border: 3px solid #4caf50;
        }
        
        .eco-section h3 {
            color: #2e7d32;
            margin-bottom: 15px;
        }
        
        .impact-summary {
            background: #e8f5e9;
            padding: 15px;
            border-radius: 10px;
            margin-top: 20px;
            border-left: 4px solid #4caf50;
        }
        
        .tracking-item {
            background: white;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 10px;
            border-left: 4px solid #e0e0e0;
        }
        
        .tracking-item.completed {
            border-left-color: #4caf50;
            opacity: 0.7;
        }
        
        .progress-bar {
            width: 100%;
            height: 30px;
            background: #e0e0e0;
            border-radius: 15px;
            overflow: hidden;
            margin: 20px 0;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(135deg, #81c784 0%, #66bb6a 100%);
            transition: width 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }
        
        .saved-budget-card {
            background: white;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 10px;
            border: 2px solid #e0e0e0;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .saved-budget-card:hover {
            border-color: #66bb6a;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .saved-budget-card.selected {
            border-color: #66bb6a;
            background: #f1f8e9;
        }
        
        .strategy-card {
            background: white;
            padding: 20px;
            border-radius: 15px;
            border: 2px solid #e0e0e0;
            margin-bottom: 20px;
        }
        
        .strategy-card h3 {
            color: #4caf50;
            margin-bottom: 10px;
        }
        
        .roi-box {
            background: #e8f5e9;
            padding: 15px;
            border-radius: 10px;
            margin-top: 15px;
        }
        
        @media print {
            body { background: white; }
            .btn-action, .btn-back, .btn-home { display: none; }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- HOME -->
        <div id="home-screen">
            <div class="header">
                <h1>üèóÔ∏è Obra Inteligente</h1>
                <p>Or√ßamento Profissional, Realista e Sustent√°vel</p>
            </div>
            
            <div class="form-group">
                <label>üìç Selecione seu Estado:</label>
                <select id="state">
                    <option value="1.00">Esp√≠rito Santo (ES) - Base</option>
                    <option value="1.15">S√£o Paulo (SP) - +15%</option>
                    <option value="1.12">Rio de Janeiro (RJ) - +12%</option>
                    <option value="0.93">Minas Gerais (MG) - -7%</option>
                    <option value="0.85">Bahia (BA) - -15%</option>
                    <option value="0.97">Rio Grande do Sul (RS) - -3%</option>
                    <option value="0.95">Paran√° (PR) - -5%</option>
                    <option value="0.98">Santa Catarina (SC) - -2%</option>
                </select>
            </div>
            
            <div class="btn-home">
                <button class="btn btn-primary" onclick="showScreen('normal')">
                    üìã Fazer Or√ßamento
                    <div style="font-size: 0.7em; margin-top: 10px;">Calcule sua obra completa</div>
                </button>
                
                <button class="btn btn-secondary" onclick="showScreen('reverse')">
                    üí∞ Tenho R$ X
                    <div style="font-size: 0.7em; margin-top: 10px;">Por onde come√ßar?</div>
                </button>
                
                <button class="btn btn-tertiary" onclick="showScreen('tracking')">
                    üìä Acompanhar Obra
                    <div style="font-size: 0.7em; margin-top: 10px;">Gerencie o andamento</div>
                </button>
                
                <button class="btn btn-quaternary" onclick="showScreen('sustainability')">
                    üå± Estrat√©gias Sustent√°veis
                    <div style="font-size: 0.7em; margin-top: 10px;">Economize √°gua e energia</div>
                </button>
            </div>
            
            <div id="saved-budgets-list"></div>
        </div>
        
        <!-- MODO NORMAL -->
        <div id="normal-screen" class="hidden">
            <button class="btn-back" onclick="showScreen('home')">‚Üê Voltar</button>
            
            <div class="header">
                <h1>üìã Fazer Or√ßamento</h1>
            </div>
            
            <div class="form-group">
                <label>Tipo de Obra:</label>
                <select id="project-type" onchange="updateNormalFields()">
                    <option value="">Selecione...</option>
                    <option value="cozinha">Cozinha</option>
                    <option value="banheiro">Banheiro</option>
                    <option value="quarto">Quarto</option>
                    <option value="sala">Sala</option>
                    <option value="casa">Casa Pequena (30-80m¬≤)</option>
                </select>
            </div>
            
            <div id="normal-fields"></div>
            
            <button class="btn btn-primary" style="width: 100%; margin-top: 20px;" onclick="calculateNormal()">
                üí∞ Calcular Or√ßamento
            </button>
            
            <div id="normal-result"></div>
        </div>
        
        <!-- MODO REVERSO -->
        <div id="reverse-screen" class="hidden">
            <button class="btn-back" onclick="showScreen('home')">‚Üê Voltar</button>
            
            <div class="header">
                <h1>üí∞ Tenho R$ X - Por onde come√ßar?</h1>
                <p>Informe seus c√¥modos e or√ßamento para receber a melhor estrat√©gia</p>
            </div>
            
            <div style="background: #fff9c4; padding: 20px; border-radius: 10px; margin-bottom: 20px;">
                <h3 style="margin-bottom: 15px; text-align: left;">üìù Marque os c√¥modos que deseja reformar:</h3>
                
                <div class="reverse-room">
                    <div class="checkbox-group">
                        <input type="checkbox" id="rev-cozinha" onchange="toggleReverseRoom('cozinha')">
                        <label for="rev-cozinha" style="margin: 0;">üç≥ Cozinha</label>
                    </div>
                    <div id="rev-cozinha-inputs" class="hidden" style="margin-top: 10px;">
                        <input type="number" placeholder="√Årea em m¬≤" id="rev-cozinha-area" min="1">
                    </div>
                </div>
                
                <div class="reverse-room">
                    <div class="checkbox-group">
                        <input type="checkbox" id="rev-banheiro" onchange="toggleReverseRoom('banheiro')">
                        <label for="rev-banheiro" style="margin: 0;">üöø Banheiro</label>
                    </div>
                    <div id="rev-banheiro-inputs" class="hidden" style="margin-top: 10px;">
                        <input type="number" placeholder="√Årea em m¬≤" id="rev-banheiro-area" min="1">
                    </div>
                </div>
                
                <div class="reverse-room">
                    <div class="checkbox-group">
                        <input type="checkbox" id="rev-quarto" onchange="toggleReverseRoom('quarto')">
                        <label for="rev-quarto" style="margin: 0;">üõèÔ∏è Quarto</label>
                    </div>
                    <div id="rev-quarto-inputs" class="hidden" style="margin-top: 10px;">
                        <input type="number" placeholder="√Årea em m¬≤" id="rev-quarto-area" min="1">
                    </div>
                </div>
                
                <div class="reverse-room">
                    <div class="checkbox-group">
                        <input type="checkbox" id="rev-sala" onchange="toggleReverseRoom('sala')">
                        <label for="rev-sala" style="margin: 0;">üõãÔ∏è Sala</label>
                    </div>
                    <div id="rev-sala-inputs" class="hidden" style="margin-top: 10px;">
                        <input type="number" placeholder="√Årea em m¬≤" id="rev-sala-area" min="1">
                    </div>
                </div>
            </div>
            
            <div class="form-group">
                <label>üíµ Quanto voc√™ tem para investir?</label>
                <input type="number" id="budget-amount" placeholder="Ex: 15000" min="1000">
            </div>
            
            <button class="btn btn-secondary" style="width: 100%; margin-top: 20px;" onclick="calculateReverse()">
                üéØ Ver Melhor Estrat√©gia
            </button>
            
            <div id="reverse-result"></div>
        </div>
        
        <!-- ACOMPANHAMENTO -->
        <div id="tracking-screen" class="hidden">
            <button class="btn-back" onclick="showScreen('home')">‚Üê Voltar</button>
            
            <div class="header">
                <h1>üìä Acompanhamento da Obra</h1>
                <p>Gerencie o progresso da sua obra</p>
            </div>
            
            <div class="form-group">
                <label>Carregar Or√ßamento Salvo:</label>
                <div id="budget-select-list"></div>
                <div class="info-box" style="margin-top: 10px;">
                    üí° Selecione um or√ßamento salvo ou crie um novo projeto abaixo
                </div>
            </div>
            
            <div class="form-group">
                <label>Nome do Projeto:</label>
                <input type="text" id="project-name" placeholder="Ex: Reforma Cozinha">
            </div>
            
            <div class="form-group">
                <label>Prazo Total (dias):</label>
                <input type="number" id="total-days" placeholder="Ex: 30" min="1">
            </div>
            
            <button class="btn btn-primary" style="width: 100%; margin-top: 20px;" onclick="initTracking()">
                ‚ñ∂Ô∏è Iniciar Acompanhamento
            </button>
            
            <div id="tracking-content" class="hidden" style="margin-top: 30px;">
                <div class="progress-bar">
                    <div class="progress-fill" id="progress-fill" style="width: 0%">0%</div>
                </div>
                
                <h3 style="text-align: left;">‚úÖ Etapas da Obra:</h3>
                <div id="tracking-items"></div>
                
                <div class="result-item total" style="margin-top: 20px;">
                    <span>Dias Trabalhados:</span>
                    <span id="days-worked">0</span>
                </div>
            </div>
        </div>
        
        <!-- SUSTENTABILIDADE -->
        <div id="sustainability-screen" class="hidden">
            <button class="btn-back" onclick="showScreen('home')">‚Üê Voltar</button>
            
            <div class="header">
                <h1>üå± Estrat√©gias Sustent√°veis</h1>
                <p>Economize √Ågua, Energia e Proteja o Planeta</p>
            </div>
            
            <div class="strategy-card">
                <h3>üíß Capta√ß√£o de √Ågua da Chuva (Cisterna)</h3>
                <p><strong>O que √©:</strong> Sistema que coleta √°gua da chuva do telhado e armazena em cisterna para reuso.</p>
                <p><strong>Usos:</strong> Descarga, lavagem de pisos, irriga√ß√£o de jardins, limpeza de √°reas externas.</p>
                <div class="roi-box">
                    <div class="result-item"><span>üí∞ Investimento Inicial:</span><span>R$ 2.500 - R$ 8.000</span></div>
                    <div class="result-item"><span>üíµ Economia Mensal:</span><span>R$ 80 - R$ 200 (30-50% da conta)</span></div>
                    <div class="result-item"><span>‚è∞ Retorno (Payback):</span><span>2-4 anos</span></div>
                    <div class="result-item"><span>üåç √Ågua Economizada:</span><span>15.000 - 30.000 litros/ano</span></div>
                </div>
                <div class="info-box">
                    ‚úÖ Reduz enchentes na cidade<br>
                    ‚úÖ Independ√™ncia em per√≠odos de racionamento<br>
                    ‚úÖ Valoriza o im√≥vel em 5-10%
                </div>
            </div>
            
            <div class="strategy-card">
                <h3>‚ôªÔ∏è Reuso de √Ågua Cinza</h3>
                <p><strong>O que √©:</strong> Tratamento e reutiliza√ß√£o da √°gua de chuveiros, lavat√≥rios e tanques.</p>
                <p><strong>Usos:</strong> Descargas, irriga√ß√£o, lavagem de pisos (N√ÉO para consumo).</p>
                <div class="roi-box">
                    <div class="result-item"><span>üí∞ Investimento Inicial:</span><span>R$ 3.000 - R$ 10.000</span></div>
                    <div class="result-item"><span>üíµ Economia Mensal:</span><span>R$ 100 - R$ 250 (40-60%)</span></div>
                    <div class="result-item"><span>‚è∞ Retorno (Payback):</span><span>2-5 anos</span></div>
                    <div class="result-item"><span>üåç √Ågua Economizada:</span><span>20.000 - 40.000 litros/ano</span></div>
                </div>
                <div class="info-box">
                    ‚úÖ Maior economia de √°gua que cisterna<br>
                    ‚úÖ Sistema funciona o ano todo<br>
                    ‚úÖ Reduz carga em esta√ß√µes de tratamento
                </div>
            </div>
            
            <div class="strategy-card">
                <h3>‚òÄÔ∏è Energia Solar Fotovoltaica</h3>
                <p><strong>O que √©:</strong> Pain√©is solares que convertem luz do sol em energia el√©trica.</p>
                <p><strong>Benef√≠cio:</strong> Redu√ß√£o de at√© 95% na conta de luz.</p>
                <div class="roi-box">
                    <div class="result-item"><span>üí∞ Investimento Inicial:</span><span>R$ 15.000 - R$ 30.000</span></div>
                    <div class="result-item"><span>üíµ Economia Mensal:</span><span>R$ 300 - R$ 600 (80-95%)</span></div>
                    <div class="result-item"><span>‚è∞ Retorno (Payback):</span><span>4-7 anos</span></div>
                    <div class="result-item"><span>üîã Vida √ötil:</span><span>25+ anos</span></div>
                    <div class="result-item"><span>üåç CO2 Evitado:</span><span>1,5 toneladas/ano</span></div>
                </div>
                <div class="info-box">
                    ‚úÖ Valoriza im√≥vel em 15-20%<br>
                    ‚úÖ Prote√ß√£o contra aumento de energia<br>
                    ‚úÖ Financiamento dispon√≠vel com juros baixos
                </div>
            </div>
            
            <div class="strategy-card">
                <h3>üåø Telhado Verde (Cobertura Ajardinada)</h3>
                <p><strong>O que √©:</strong> Vegeta√ß√£o plantada sobre o telhado com impermeabiliza√ß√£o especial.</p>
                <p><strong>Benef√≠cio:</strong> Reduz temperatura interna em at√© 8¬∞C.</p>
                <div class="roi-box">
                    <div class="result-item"><span>üí∞ Investimento Inicial:</span><span>R$ 150 - R$ 300/m¬≤</span></div>
                    <div class="result-item"><span>üíµ Economia Mensal:</span><span>R$ 50 - R$ 150 (redu√ß√£o ar-condicionado)</span></div>
                    <div class="result-item"><span>‚è∞ Retorno (Payback):</span><span>5-10 anos</span></div>
                    <div class="result-item"><span>üå± Absor√ß√£o CO2:</span><span>200g/m¬≤/ano</span></div>
                </div>
                <div class="info-box">
                    ‚úÖ Aumenta vida √∫til da impermeabiliza√ß√£o<br>
                    ‚úÖ Melhora qualidade do ar<br>
                    ‚úÖ Reduz ru√≠dos externos em at√© 40dB<br>
                    ‚úÖ Desconto de at√© 10% no IPTU em algumas cidades
                </div>
            </div>
            
            <div class="strategy-card">
                <h3>üí° Ilumina√ß√£o LED + Sensores</h3>
                <p><strong>O que √©:</strong> Substitui√ß√£o de l√¢mpadas por LED e instala√ß√£o de sensores de presen√ßa.</p>
                <div class="roi-box">
                    <div class="result-item"><span>üí∞ Investimento Inicial:</span><span>R$ 800 - R$ 2.000</span></div>
                    <div class="result-item"><span>üíµ Economia Mensal:</span><span>R$ 40 - R$ 100 (30-50% ilumina√ß√£o)</span></div>
                    <div class="result-item"><span>‚è∞ Retorno (Payback):</span><span>1-2 anos</span></div>
                    <div class="result-item"><span>üí° Vida √ötil LED:</span><span>25.000 - 50.000 horas</span></div>
                </div>
                <div class="info-box">
                    ‚úÖ Investimento mais baixo e r√°pido retorno<br>
                    ‚úÖ LED n√£o esquenta o ambiente<br>
                    ‚úÖ Sensores economizam at√© 60% adicional
                </div>
            </div>
            
            <div class="strategy-card">
                <h3>üö∞ Dispositivos Economizadores</h3>
                <p><strong>O que √©:</strong> Torneiras com arejador, chuveiros econ√¥micos, descargas com duplo acionamento.</p>
                <div class="roi-box">
                    <div class="result-item"><span>üí∞ Investimento Inicial:</span><span>R$ 400 - R$ 1.500</span></div>
                    <div class="result-item"><span>üíµ Economia Mensal:</span><span>R$ 60 - R$ 150 (30-50%)</span></div>
                    <div class="result-item"><span>‚è∞ Retorno (Payback):</span><span>6-12 meses</span></div>
                    <div class="result-item"><span>üåç √Ågua Economizada:</span><span>40.000 - 60.000 litros/ano</span></div>
                </div>
                <div class="info-box">
                    ‚úÖ Mais barato e r√°pido de implementar<br>
                    ‚úÖ N√£o requer obra<br>
                    ‚úÖ Retorno em menos de 1 ano
                </div>
            </div>
            
            <div class="strategy-card">
                <h3>üå¨Ô∏è Ventila√ß√£o Natural + Ilumina√ß√£o Natural</h3>
                <p><strong>O que √©:</strong> Projeto que maximiza entrada de luz solar e circula√ß√£o de ar natural.</p>
                <p><strong>Inclui:</strong> Janelas bem posicionadas, claraboias, ventila√ß√£o cruzada.</p>
                <div class="roi-box">
                    <div class="result-item"><span>üí∞ Investimento Inicial:</span><span>R$ 0 - R$ 3.000</span></div>
                    <div class="result-item"><span>üíµ Economia Mensal:</span><span>R$ 80 - R$ 200</span></div>
                    <div class="result-item"><span>‚è∞ Retorno (Payback):</span><span>0-2 anos</span></div>
                </div>
                <div class="info-box">
                    ‚úÖ Reduz uso de luz artificial em 40-60%<br>
                    ‚úÖ Reduz uso de ar-condicionado<br>
                    ‚úÖ Melhora sa√∫de e bem-estar
                </div>
            </div>
            
            <div class="strategy-card">
                <h3>‚ôªÔ∏è Compostagem Dom√©stica</h3>
                <p><strong>O que √©:</strong> Transformar restos org√¢nicos em adubo.</p>
                <div class="roi-box">
                    <div class="result-item"><span>üí∞ Investimento Inicial:</span><span>R$ 150 - R$ 500</span></div>
                    <div class="result-item"><span>üíµ Economia Mensal:</span><span>R$ 20 - R$ 50 (adubo)</span></div>
                    <div class="result-item"><span>‚è∞ Retorno (Payback):</span><span>1-2 anos</span></div>
                    <div class="result-item"><span>üåç Lixo Reduzido:</span><span>200-400 kg/ano</span></div>
                </div>
                <div class="info-box">
                    ‚úÖ Reduz 30-40% do lixo dom√©stico<br>
                    ‚úÖ Adubo gr√°tis para jardim/horta<br>
                    ‚úÖ Reduz metano em aterros
                </div>
            </div>
            
            <div class="impact-summary">
                <h3>üåç Impacto Combinado das Estrat√©gias</h3>
                <p><strong>Se voc√™ implementar TODAS essas estrat√©gias em uma casa:</strong></p>
                <div class="result-item"><span>üí∞ Investimento Total:</span><span>R$ 22.000 - R$ 55.000</span></div>
                <div class="result-item"><span>üíµ Economia Mensal:</span><span>R$ 730 - R$ 1.650</span></div>
                <div class="result-item"><span>üìÖ Economia Anual:</span><span>R$ 8.760 - R$ 19.800</span></div>
                <div class="result-item"><span>‚è∞ Payback Total:</span><span>3-6 anos</span></div>
                <div class="result-item"><span>üíö Economia 30 anos:</span><span>R$ 262.800 - R$ 594.000</span></div>
                <div class="result-item"><span>üåç CO2 Evitado/Ano:</span><span>3-5 toneladas</span></div>
                <div class="result-item"><span>üå≥ Equivalente:</span><span>700-1.200 √°rvores plantadas</span></div>
            </div>
        </div>
    </div>
    
    <script>
        let currentState = 1.0;
        let selectedMaterials = {};
        let walls = [];
        let trackingSteps = [];
        let savedBudgets = [];
        let currentBudget = null;
        
        const specificMaterials = {
            porcelanato: [
                {name: 'Portobello 60x60 Branco', price: 95},
                {name: 'Eliane Eco 60x60', price: 90, eco: true},
                {name: 'Cecrisa 80x80', price: 120},
                {name: 'Portinari HD', price: 135},
                {name: 'Incepa Esmaltado', price: 110},
                {name: 'Ceusa Green Line', price: 92, eco: true},
                {name: 'Outro (informar valor)', price: 0, custom: true}
            ],
            ceramica: [
                {name: 'Cecrisa 45x45', price: 55},
                {name: 'Eliane 50x50', price: 65},
                {name: 'Incefra Popular', price: 52},
                {name: 'Portobello B√°sico', price: 60},
                {name: 'Outro (informar valor)', price: 0, custom: true}
            ],
            laminado: [
                {name: 'Durafloor New Way', price: 65},
                {name: 'Eucafloor Prime', price: 75},
                {name: 'Durafloor Studio', price: 95},
                {name: 'Eucafloor Elegance', price: 85},
                {name: 'Altro (informar valor)', price: 0, custom: true}
            ],
            bambu: [
                {name: 'Bambutec Carbonizado', price: 95, eco: true},
                {name: 'Eucafloor Eco Bambu', price: 105, eco: true},
                {name: 'Bamboomax Natural', price: 98, eco: true},
                {name: 'BambuBrasil Premium', price: 110, eco: true},
                {name: 'Outro (informar valor)', price: 0, custom: true}
            ],
            pintura: [
                {name: 'Suvinil L√°tex', price: 25},
                {name: 'Coral Acr√≠lica', price: 28},
                {name: 'Sherwin Williams', price: 35},
                {name: 'Suvinil Carbono Zero', price: 32, eco: true},
                {name: 'Coral Ecocryl', price: 30, eco: true},
                {name: 'Killing Green', price: 34, eco: true},
                {name: 'Outro (informar valor)', price: 0, custom: true}
            ],
            azulejo: [
                {name: 'Eliane Branco', price: 55},
                {name: 'Portobello Brilhante', price: 65},
                {name: 'Cecrisa Premium', price: 75},
                {name: 'Incepa Green Eco', price: 75, eco: true},
                {name: 'Ceusa Sustent√°vel', price: 70, eco: true},
                {name: 'Outro (informar valor)', price: 0, custom: true}
            ],
            loucas: [
                {name: 'Kit B√°sico Deca (vaso + pia + chuveiro + 2 torneiras)', price: 1200},
                {name: 'Kit Premium Deca (vaso dual + cuba + chuveiro el√©trico)', price: 2500},
                {name: 'Kit Eco Deca (descarga 3/6L + torneiras arejadoras)', price: 1800, eco: true},
                {name: 'Kit Docol Duo Econ√¥mico', price: 1650, eco: true},
                {name: 'Outro (informar valor)', price: 0, custom: true}
            ],
            bancada: [
                {name: 'Sem Bancada', price: 0},
                {name: 'Granito Cinza Corumb√°', price: 350},
                {name: 'M√°rmore Branco', price: 450},
                {name: 'Quartzo Branco Prime', price: 650},
                {name: 'Silestone Eco 75% Reciclado', price: 700, eco: true},
                {name: 'Dekton Sustent√°vel', price: 680, eco: true},
                {name: 'Outro (informar valor)', price: 0, custom: true}
            ]
        };
        
        function showScreen(screen) {
            currentState = parseFloat(document.getElementById('state').value);
            ['home', 'normal', 'reverse', 'tracking', 'sustainability'].forEach(s => {
                document.getElementById(s + '-screen').classList.add('hidden');
            });
            document.getElementById(screen + '-screen').classList.remove('hidden');
            
            if (screen === 'home') {
                loadSavedBudgets();
            } else if (screen === 'tracking') {
                loadBudgetSelectList();
            }
        }
        
        function updateNormalFields() {
            const type = document.getElementById('project-type').value;
            const container = document.getElementById('normal-fields');
            container.innerHTML = '';
            selectedMaterials = {};
            walls = [];
            
            if (!type) return;
            
            container.innerHTML = `
                <div class="form-group">
                    <label>üìê √Årea do Piso (m¬≤):</label>
                    <input type="number" id="area" placeholder="Ex: 10" min="1">
                </div>
            `;
            
            if (type === 'cozinha' || type === 'banheiro') {
                addKitchenBathroomFields(type);
            } else if (type === 'quarto' || type === 'sala') {
                addBedroomLivingFields(type);
            } else if (type === 'casa') {
                addCasaFields();
            }
            
            if (type !== 'casa') {
                container.innerHTML += `
                    <div class="form-group">
                        <div class="checkbox-group">
                            <input type="checkbox" id="demolition" onchange="toggleDemolition()">
                            <label for="demolition" style="margin: 0;">üî® Precisa demolir alguma parede?</label>
                        </div>
                        <div id="demolition-inputs" class="hidden" style="margin-top: 10px;">
                            <input type="number" id="demolition-area" placeholder="√Årea da parede (m¬≤)" min="0.1" step="0.1">
                            <div class="warning" style="margin-top: 10px;">
                                ‚ö†Ô∏è ATEN√á√ÉO: Consulte um engenheiro civil antes de demolir para verificar se n√£o √© parede estrutural!
                            </div>
                        </div>
                    </div>
                `;
                
                let installations = '<div class="form-group"><label>‚ö° Instala√ß√µes:</label>';
                
                if (type === 'cozinha' || type === 'banheiro') {
                    installations += `
                        <div class="checkbox-group">
                            <input type="checkbox" id="plumbing">
                            <label for="plumbing" style="margin: 0;">üíß Refazer Hidr√°ulica</label>
                        </div>
                    `;
                }
                
                installations += `
                    <div class="checkbox-group">
                        <input type="checkbox" id="electrical">
                        <label for="electrical" style="margin: 0;">‚ö° Refazer El√©trica</label>
                    </div>
                </div>`;
                
                container.innerHTML += installations;
            }
        }
        
        function addKitchenBathroomFields(type) {
            const container = document.getElementById('normal-fields');
            
            container.innerHTML += `
                <div class="form-group">
                    <label>üß± Paredes para Revestimento:</label>
                    <div id="walls-container"></div>
                    <button class="btn-add-wall" onclick="addWall()">+ Adicionar Parede</button>
                    <div class="info-box">
                        üí° ${type === 'cozinha' ? 'Cozinha: altura padr√£o 1,5m' : 'Banheiro: altura padr√£o at√© o teto (2,0-2,5m)'}<br>
                        Adicione apenas as paredes que receber√£o revestimento
                    </div>
                </div>
            `;
            
            addWall();
            
            addMaterialSelect('Piso', 'piso', ['ceramica', 'porcelanato']);
            addMaterialSelect('Azulejo/Revestimento', 'azulejo', ['azulejo']);
            
            if (type === 'cozinha') {
                addMaterialSelect('Bancada', 'bancada', ['bancada']);
                container.innerHTML += `
                    <div class="form-group" id="bancada-length-group" style="display: none;">
                        <label>üìè Comprimento da Bancada (metros lineares):</label>
                        <input type="number" id="bancada-length" placeholder="Ex: 2.5" min="0" step="0.1">
                        <div class="info-box">üí° Bancadas s√£o vendidas por metro linear (largura padr√£o 60cm)</div>
                    </div>
                `;
            }
            
            if (type === 'banheiro') {
                addMaterialSelect('Kit de Lou√ßas', 'loucas', ['loucas']);
                container.innerHTML += `
                    <div class="form-group">
                        <label>üöø Boxe:</label>
                        <select id="boxe">
                            <option value="0">Sem Boxe</option>
                            <option value="450">Boxe Acr√≠lico - R$ 450</option>
                            <option value="850">Boxe Vidro Temperado - R$ 850</option>
                            <option value="1200">Boxe Blindex - R$ 1.200</option>
                        </select>
                    </div>
                `;
            }
        }
        
        function addWall() {
            if (walls.length >= 6) {
                alert('M√°ximo de 6 paredes');
                return;
            }
            
            const wallId = walls.length;
            walls.push({id: wallId, width: 0, height: 0});
            
            const container = document.getElementById('walls-container');
            const wallDiv = document.createElement('div');
            wallDiv.className = 'wall-item';
            wallDiv.id = 'wall-' + wallId;
            wallDiv.innerHTML = `
                <strong>Parede ${wallId + 1}</strong>
                ${wallId > 0 ? '<button class="btn-remove-wall" onclick="removeWall(' + wallId + ')">Remover</button>' : ''}
                <div class="grid-2" style="margin-top: 10px;">
                    <input type="number" placeholder="Largura (m)" min="0.1" step="0.1" 
                           onchange="updateWall(${wallId}, 'width', this.value)">
                    <input type="number" placeholder="Altura (m)" min="0.1" step="0.1"
                           onchange="updateWall(${wallId}, 'height', this.value)">
                </div>
            `;
            container.appendChild(wallDiv);
        }
        
        function removeWall(id) {
            document.getElementById('wall-' + id).remove();
            walls = walls.filter(w => w.id !== id);
        }
        
        function updateWall(id, prop, value) {
            const wall = walls.find(w => w.id === id);
            if (wall) wall[prop] = parseFloat(value) || 0;
        }
        
        function addBedroomLivingFields(type) {
            const container = document.getElementById('normal-fields');
            addMaterialSelect('Piso', 'piso', ['laminado', 'porcelanato', 'bambu']);
            addMaterialSelect('Pintura', 'pintura', ['pintura']);
        }
        
        function addCasaFields() {
            const container = document.getElementById('normal-fields');
            
            container.innerHTML += `
                <div class="form-group">
                    <label>üèóÔ∏è Funda√ß√£o:</label>
                    <select id="fundacao">
                        <option value="200">Sapata Corrida - R$ 200/m¬≤</option>
                        <option value="180">Radier - R$ 180/m¬≤</option>
                        <option value="280">Estacas - R$ 280/m¬≤</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>üß± Alvenaria:</label>
                    <select id="alvenaria">
                        <option value="150">Tijolo Cer√¢mico - R$ 150/m¬≤</option>
                        <option value="165">Bloco Cer√¢mico - R$ 165/m¬≤</option>
                        <option value="155">Bloco Concreto - R$ 155/m¬≤</option>
                        <option value="135-eco">üå± Tijolo Ecol√≥gico Solo-Cimento - R$ 135/m¬≤ (Economiza 30%!)</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>üè† Cobertura:</label>
                    <select id="cobertura">
                        <option value="120">Telha Cer√¢mica - R$ 120/m¬≤</option>
                        <option value="95">Fibrocimento - R$ 95/m¬≤</option>
                        <option value="110">Telha Met√°lica - R$ 110/m¬≤</option>
                        <option value="145">Telha T√©rmica - R$ 145/m¬≤</option>
                        <option value="125-eco">üå± Telha Ecol√≥gica PET/Fibra - R$ 125/m¬≤ (Isolamento superior!)</option>
                        <option value="165">Laje Pr√©-moldada - R$ 165/m¬≤</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>üö™ Esquadrias (Portas e Janelas):</label>
                    <select id="esquadrias">
                        <option value="3800">Portas Pinus + Janelas Alum√≠nio - R$ 3.800</option>
                        <option value="3200">Portas Compensado + Janelas Alum√≠nio - R$ 3.200</option>
                        <option value="5200">Portas Madeira de Lei + Janelas - R$ 5.200</option>
                        <option value="5500">Portas MDF + Janelas Alum√≠nio - R$ 5.500</option>
                    </select>
                    <div class="info-box">
                        üí° Madeira de Lei: mais cara mas muito dur√°vel<br>
                        MDF: acabamento superior, resistente √† umidade<br>
                        Pinus/Compensado: op√ß√µes econ√¥micas
                    </div>
                </div>
            `;
            
            addMaterialSelect('Piso Interno', 'piso', ['ceramica', 'porcelanato', 'laminado', 'bambu']);
            addMaterialSelect('Pintura', 'pintura', ['pintura']);
        }
        
        function addMaterialSelect(title, category, types) {
            const container = document.getElementById('normal-fields');
            let options = [];
            
            types.forEach(type => {
                if (specificMaterials[type]) {
                    options = options.concat(specificMaterials[type]);
                }
            });
            
            const hasEco = options.some(opt => opt.eco);
            
            let html = `<div class="form-group">`;
            
            if (hasEco) {
                html += `
                    <div class="eco-section">
                        <h3>üå± ${title} - Op√ß√µes Sustent√°veis</h3>
                        <div style="display: grid; gap: 10px;">
                `;
                
                options.filter(opt => opt.eco).forEach((opt, idx) => {
                    const realIdx = options.indexOf(opt);
                    html += `
                        <div class="material-option eco" onclick="selectMaterialFromList('${category}', ${realIdx})">
                            <div class="eco-badge">üå± SUSTENT√ÅVEL</div>
                            <div style="font-weight: bold;">${opt.name}</div>
                            <div style="color: #2e7d32; font-size: 1.1em; font-weight: bold;">
                                ${opt.price > 0 ? 'R$ ' + opt.price + (category === 'bancada' && opt.price > 0 ? '/m' : '/m¬≤') : 'Personalize'}
                            </div>
                        </div>
                    `;
                });
                
                html += `</div></div>`;
            }
            
            html += `<label>${title} - Todas as Op√ß√µes:</label>
                <select id="${category}-select" onchange="selectMaterialFromDropdown('${category}')">
                    <option value="">Selecione...</option>`;
            
            options.forEach((opt, idx) => {
                html += `<option value="${idx}" ${opt.eco ? 'style="color: #4caf50; font-weight: bold;"' : ''}>
                    ${opt.eco ? 'üå± ' : ''}${opt.name} ${opt.price > 0 ? '- R$ ' + opt.price + (category === 'bancada' && opt.price > 0 ? '/m' : category === 'loucas' ? '' : '/m¬≤') : ''}
                </option>`;
            });
            
            html += `</select>
                <div id="${category}-custom" class="hidden" style="margin-top: 10px;">
                    <input type="number" id="${category}-custom-value" placeholder="Digite o valor" min="0" step="0.01">
                </div>
            </div>`;
            
            container.innerHTML += html;
            window['materials_' + category] = options;
        }
        
        function selectMaterialFromList(category, idx) {
            const select = document.getElementById(category + '-select');
            select.value = idx;
            selectMaterialFromDropdown(category);
        }
        
        function selectMaterialFromDropdown(category) {
            const select = document.getElementById(category + '-select');
            const idx = parseInt(select.value);
            const materials = window['materials_' + category];
            
            if (!isNaN(idx) && materials) {
                selectedMaterials[category] = materials[idx];
                
                const customDiv = document.getElementById(category + '-custom');
                if (materials[idx].custom) {
                    customDiv.classList.remove('hidden');
                } else {
                    customDiv.classList.add('hidden');
                }
                
                if (category === 'bancada' && materials[idx].price > 0) {
                    document.getElementById('bancada-length-group').style.display = 'block';
                } else if (category === 'bancada') {
                    document.getElementById('bancada-length-group').style.display = 'none';
                }
            }
        }
        
        function toggleDemolition() {
            const checked = document.getElementById('demolition').checked;
            document.getElementById('demolition-inputs').classList.toggle('hidden', !checked);
        }
        
        function toggleReverseRoom(room) {
            const checked = document.getElementById('rev-' + room).checked;
            document.getElementById('rev-' + room + '-inputs').classList.toggle('hidden', !checked);
        }
        
        function formatCurrency(value) {
            return value.toLocaleString('pt-BR', {minimumFractionDigits: 2, maximumFractionDigits: 2});
        }
        
        function calculateNormal() {
            const type = document.getElementById('project-type').value;
            const area = parseFloat(document.getElementById('area').value);
            
            if (!type || !area) {
                alert('Preencha todos os campos obrigat√≥rios!');
                return;
            }
            
            let totalMaterials = 0;
            let details = [];
            let laborHours = 0;
            let ecoCount = 0;
            let co2Saved = 0;
            
            if (type === 'casa') {
                calculateCasa(area);
                return;
            }
            
            if (selectedMaterials.piso) {
                let pisoPrice = selectedMaterials.piso.price;
                if (selectedMaterials.piso.custom) {
                    pisoPrice = parseFloat(document.getElementById('piso-custom-value').value) || 0;
                }
                const cost = area * pisoPrice * currentState;
                totalMaterials += cost;
                details.push({label: `Piso ${selectedMaterials.piso.name}`, value: cost, eco: selectedMaterials.piso.eco});
                laborHours += area * 1.5;
                if (selectedMaterials.piso.eco) { ecoCount++; co2Saved += 0.2; }
            }
            
            if ((type === 'cozinha' || type === 'banheiro') && selectedMaterials.azulejo) {
                let totalWallArea = walls.reduce((sum, w) => sum + (w.width * w.height), 0);
                
                let azulejoPrice = selectedMaterials.azulejo.price;
                if (selectedMaterials.azulejo.custom) {
                    azulejoPrice = parseFloat(document.getElementById('azulejo-custom-value').value) || 0;
                }
                
                if (totalWallArea > 0) {
                    const cost = totalWallArea * azulejoPrice * currentState;
                    totalMaterials += cost;
                    details.push({label: `${selectedMaterials.azulejo.name} (${totalWallArea.toFixed(1)}m¬≤)`, value: cost, eco: selectedMaterials.azulejo.eco});
                    laborHours += totalWallArea * 2;
                    if (selectedMaterials.azulejo.eco) { ecoCount++; co2Saved += 0.15; }
                }
            }
            
            if (type === 'cozinha' && selectedMaterials.bancada && selectedMaterials.bancada.price > 0) {
                const length = parseFloat(document.getElementById('bancada-length').value) || 0;
                if (length > 0) {
                    let bancadaPrice = selectedMaterials.bancada.price;
                    if (selectedMaterials.bancada.custom) {
                        bancadaPrice = parseFloat(document.getElementById('bancada-custom-value').value) || 0;
                    }
                    const cost = length * bancadaPrice * currentState;
                    totalMaterials += cost;
                    details.push({label: `Bancada ${selectedMaterials.bancada.name} (${length}m)`, value: cost, eco: selectedMaterials.bancada.eco});
                    laborHours += length * 3;
                    if (selectedMaterials.bancada.eco) { ecoCount++; co2Saved += 0.1; }
                }
            }
            
            if (type === 'banheiro' && selectedMaterials.loucas) {
                let loucasPrice = selectedMaterials.loucas.price;
                if (selectedMaterials.loucas.custom) {
                    loucasPrice = parseFloat(document.getElementById('loucas-custom-value').value) || 0;
                }
                const cost = loucasPrice * currentState;
                totalMaterials += cost;
                details.push({label: selectedMaterials.loucas.name, value: cost, eco: selectedMaterials.loucas.eco});
                laborHours += 16;
                if (selectedMaterials.loucas.eco) { ecoCount++; co2Saved += 0.3; }
            }
            
            if (type === 'banheiro') {
                const boxePrice = parseFloat(document.getElementById('boxe').value) || 0;
                if (boxePrice > 0) {
                    const cost = boxePrice * currentState;
                    totalMaterials += cost;
                    details.push({label: 'Boxe', value: cost});
                    laborHours += 4;
                }
            }
            
            if ((type === 'quarto' || type === 'sala') && selectedMaterials.pintura) {
                const paintArea = area * 3.8;
                let pinturaPrice = selectedMaterials.pintura.price;
                if (selectedMaterials.pintura.custom) {
                    pinturaPrice = parseFloat(document.getElementById('pintura-custom-value').value) || 0;
                }
                const cost = paintArea * pinturaPrice * currentState;
                totalMaterials += cost;
                details.push({label: `Pintura ${selectedMaterials.pintura.name} (${paintArea.toFixed(1)}m¬≤)`, value: cost, eco: selectedMaterials.pintura.eco});
                laborHours += paintArea * 0.5;
                if (selectedMaterials.pintura.eco) { ecoCount++; co2Saved += 0.25; }
            }
            
            if (document.getElementById('plumbing')?.checked) {
                const cost = area * 85 * currentState;
                totalMaterials += cost;
                details.push({label: 'Refazer Hidr√°ulica', value: cost});
                laborHours += area * 2.5;
            }
            
            if (document.getElementById('electrical')?.checked) {
                const cost = area * 95 * currentState;
                totalMaterials += cost;
                details.push({label: 'Refazer El√©trica', value: cost});
                laborHours += area * 2;
            }
            
            if (document.getElementById('demolition')?.checked) {
                const demolArea = parseFloat(document.getElementById('demolition-area').value) || 0;
                if (demolArea > 0) {
                    const cost = demolArea * 120 * currentState;
                    totalMaterials += cost;
                    details.push({label: `Demoli√ß√£o (${demolArea}m¬≤)`, value: cost});
                    laborHours += demolArea * 3;
                }
            }
            
            const labor = totalMaterials * 0.50;
            const baseTotal = totalMaterials + labor;
            
            const unexpected = baseTotal * 0.125;
            const loss = baseTotal * 0.05;
            const delay = baseTotal * 0.10;
            const realisticTotal = baseTotal + unexpected + loss;
            const safeTotal = baseTotal + unexpected + loss + delay;
            
            const workDays = Math.ceil(laborHours / 8);
            const optimistic = Math.ceil(workDays * 0.8);
            const realistic = workDays;
            const delayed = Math.ceil(workDays * 1.4);
            
            const workers = type === 'banheiro' || type === 'cozinha' ? '1 pedreiro + 1 ajudante' : '1 instalador/pintor + 1 ajudante';
            
            currentBudget = {
                type,
                area,
                materials: selectedMaterials,
                baseTotal,
                realisticTotal,
                safeTotal,
                workDays: realistic,
                workers,
                date: new Date().toLocaleDateString()
            };
            
            displayResult(details, labor, baseTotal, unexpected, loss, delay, realisticTotal, safeTotal, 
                          optimistic, realistic, delayed, workers, laborHours, ecoCount, co2Saved * area);
        }
        
        function calculateCasa(area) {
            const fundacao = parseFloat(document.getElementById('fundacao').value);
            const alvenariaVal = document.getElementById('alvenaria').value.split('-');
            const alvenaria = parseFloat(alvenariaVal[0]);
            const alvEco = alvenariaVal[1] === 'eco';
            
            const coberturaVal = document.getElementById('cobertura').value.split('-');
            const cobertura = parseFloat(coberturaVal[0]);
            const cobEco = coberturaVal[1] === 'eco';
            
            const esquadrias = parseFloat(document.getElementById('esquadrias').value);
            
            let pisoPrice = selectedMaterials.piso?.price || 75;
            let pisoEco = selectedMaterials.piso?.eco || false;
            let pinturaPrice = selectedMaterials.pintura?.price || 25;
            let pinturaEco = selectedMaterials.pintura?.eco || false;
            
            let total = 0;
            let details = [];
            let ecoCount = 0;
            let co2Saved = 0;
            
            total += area * fundacao * currentState;
            details.push({label: 'Funda√ß√£o', value: area * fundacao * currentState});
            
            total += area * alvenaria * currentState;
            details.push({label: 'Alvenaria', value: area * alvenaria * currentState, eco: alvEco});
            if (alvEco) { ecoCount++; co2Saved += area * 1.2; }
            
            const roofArea = area * 1.35;
            total += roofArea * cobertura * currentState;
            details.push({label: 'Cobertura', value: roofArea * cobertura * currentState, eco: cobEco});
            if (cobEco) { ecoCount++; co2Saved += roofArea * 0.8; }
            
            total += esquadrias * currentState;
            details.push({label: 'Esquadrias', value: esquadrias * currentState});
            
            total += area * pisoPrice * currentState;
            details.push({label: 'Piso', value: area * pisoPrice * currentState, eco: pisoEco});
            if (pisoEco) { ecoCount++; co2Saved += area * 0.3; }
            
            const paintArea = area * 3.8;
            total += paintArea * pinturaPrice * currentState;
            details.push({label: 'Pintura', value: paintArea * pinturaPrice * currentState, eco: pinturaEco});
            if (pinturaEco) { ecoCount++; co2Saved += paintArea * 0.2; }
            
            total += area * 85 * currentState;
            details.push({label: 'Hidr√°ulica', value: area * 85 * currentState});
            
            total += area * 95 * currentState;
            details.push({label: 'El√©trica', value: area * 95 * currentState});
            
            const labor = total * 0.65;
            const baseTotal = total + labor;
            
            const unexpected = baseTotal * 0.125;
            const loss = baseTotal * 0.05;
            const delay = baseTotal * 0.10;
            const realisticTotal = baseTotal + unexpected + loss;
            const safeTotal = baseTotal + unexpected + loss + delay;
            
            const workDays = Math.ceil(area * 4);
            const optimistic = Math.ceil(workDays * 0.8);
            const realistic = workDays;
            const delayed = Math.ceil(workDays * 1.4);
            
            const workers = '2 pedreiros + 2 ajudantes + 1 eletricista + 1 encanador';
            const laborHours = workDays * 8 * 6;
            
            currentBudget = {
                type: 'casa',
                area,
                materials: selectedMaterials,
                baseTotal,
                realisticTotal,
                safeTotal,
                workDays: realistic,
                workers,
                date: new Date().toLocaleDateString()
            };
            
            displayResult(details, labor, baseTotal, unexpected, loss, delay, realisticTotal, safeTotal,
                          optimistic, realistic, delayed, workers, laborHours, ecoCount, co2Saved);
        }
        
        function displayResult(details, labor, baseTotal, unexpected, loss, delay, realisticTotal, safeTotal,
                               optimistic, realistic, delayed, workers, laborHours, ecoCount, co2Saved) {
            let html = '<div class="result">';
            html += '<h2>üìä Or√ßamento Detalhado</h2>';
            
            details.forEach(item => {
                const ecoMark = item.eco ? ' <span class="eco-badge">üå± SUSTENT√ÅVEL</span>' : '';
                html += `<div class="result-item"><span class="label">${item.label}${ecoMark}</span><span class="value">R$ ${formatCurrency(item.value)}</span></div>`;
            });
            
            html += `<div class="result-item"><span class="label">M√£o de Obra (Pedreiro + Ajudante)</span><span class="value">R$ ${formatCurrency(labor)}</span></div>`;
            html += `<div class="result-item total"><span class="label">üí∞ Or√ßamento Base</span><span class="value">R$ ${formatCurrency(baseTotal)}</span></div>`;
            
            if (ecoCount > 0) {
                html += '<div class="impact-summary">';
                html += '<h3>üåç Seu Impacto Sustent√°vel</h3>';
                html += `<div class="result-item"><span class="label">Materiais sustent√°veis escolhidos</span><span class="value">${ecoCount} üå±</span></div>`;
                html += `<div class="result-item"><span class="label">CO2 evitado</span><span class="value">${co2Saved.toFixed(1)} toneladas</span></div>`;
                html += `<div class="result-item"><span class="label">Equivalente a</span><span class="value">${Math.round(co2Saved * 235)} √°rvores plantadas üå≥</span></div>`;
                html += '</div>';
            }
            
            html += '<div class="contingency">';
            html += '<h3>‚ö†Ô∏è Conting√™ncias Recomendadas</h3>';
            html += `<div class="result-item"><span class="label">Imprevistos (12,5%)</span><span class="value">R$ ${formatCurrency(unexpected)}</span></div>`;
            html += `<div class="result-item"><span class="label">Perda Material (5%)</span><span class="value">R$ ${formatCurrency(loss)}</span></div>`;
            html += `<div class="result-item"><span class="label">Atrasos/Falta MO (10%)</span><span class="value">R$ ${formatCurrency(delay)}</span></div>`;
            html += `<div class="result-item" style="background: #fdd835;"><span class="label"><strong>üíº Or√ßamento Realista</strong></span><span class="value"><strong>R$ ${formatCurrency(realisticTotal)}</strong></span></div>`;
            html += `<div class="result-item" style="background: #66bb6a; color: white;"><span class="label"><strong>üìä Or√ßamento Seguro</strong></span><span class="value"><strong>R$ ${formatCurrency(safeTotal)}</strong></span></div>`;
            html += '</div>';
            
            html += '<div class="timeline">';
            html += '<h3>‚è∞ Cronograma de Execu√ß√£o</h3>';
            html += `<div class="result-item"><span>‚ö° Otimista (80%)</span><span><strong>${optimistic} dias √∫teis</strong></span></div>`;
            html += `<div class="result-item"><span>üìÖ Realista (100%)</span><span><strong>${realistic} dias √∫teis</strong></span></div>`;
            html += `<div class="result-item"><span>‚ö†Ô∏è Com Atraso (140%)</span><span><strong>${delayed} dias √∫teis</strong></span></div>`;
            html += '<h3 style="margin-top: 20px;">üë∑ Equipe Necess√°ria</h3>';
            html += `<div class="result-item"><span>Profissionais</span><span><strong>${workers}</strong></span></div>`;
            html += `<div class="result-item"><span>Total Homem-Hora (HH)</span><span><strong>${Math.ceil(laborHours)}h</strong></span></div>`;
            html += '<div class="info-box">üí° Baseado em 8h/dia. Para terminar mais r√°pido, contrate mais profissionais!</div>';
            html += '</div>';
            
            html += '<button class="btn-action btn-save" onclick="saveBudget()">üíæ Salvar Or√ßamento</button>';
            html += '<button class="btn-action btn-print" onclick="window.print()">üñ®Ô∏è Imprimir</button>';
            html += '</div>';
            
            document.getElementById('normal-result').innerHTML = html;
        }
        
        function saveBudget() {
            if (!currentBudget) {
                alert('Nenhum or√ßamento para salvar!');
                return;
            }
            
            const name = prompt('Nome do or√ßamento:', `${currentBudget.type} ${currentBudget.area}m¬≤ - ${currentBudget.date}`);
            if (name) {
                savedBudgets.push({
                    ...currentBudget,
                    name,
                    id: Date.now()
                });
                alert('‚úÖ Or√ßamento salvo com sucesso!');
                loadSavedBudgets();
            }
        }
        
        function loadSavedBudgets() {
            const container = document.getElementById('saved-budgets-list');
            if (savedBudgets.length === 0) {
                container.innerHTML = '';
                return;
            }
            
            let html = '<h3 style="text-align: left; margin-top: 30px;">üìÇ Or√ßamentos Salvos</h3>';
            savedBudgets.slice(-5).reverse().forEach(budget => {
                html += `
                    <div class="saved-budget-card">
                        <strong>${budget.name}</strong><br>
                        <small>Base: R$ ${formatCurrency(budget.baseTotal)} | Realista: R$ ${formatCurrency(budget.realisticTotal)}</small>
                    </div>
                `;
            });
            container.innerHTML = html;
        }
        
        function loadBudgetSelectList() {
            const container = document.getElementById('budget-select-list');
            if (savedBudgets.length === 0) {
                container.innerHTML = '<div class="info-box">Nenhum or√ßamento salvo ainda. Crie um or√ßamento primeiro!</div>';
                return;
            }
            
            let html = '';
            savedBudgets.forEach((budget, idx) => {
                html += `
                    <div class="saved-budget-card" onclick="selectBudgetForTracking(${idx})">
                        <strong>${budget.name}</strong><br>
                        <small>${budget.type} ${budget.area}m¬≤ | ${budget.workDays} dias | ${budget.workers}</small>
                    </div>
                `;
            });
            container.innerHTML = html;
        }
        
        function selectBudgetForTracking(idx) {
            const budget = savedBudgets[idx];
            document.getElementById('project-name').value = budget.name;
            document.getElementById('total-days').value = budget.workDays;
            
            document.querySelectorAll('.saved-budget-card').forEach((el, i) => {
                el.classList.toggle('selected', i === idx);
            });
        }
        
        function calculateReverse() {
            const budget = parseFloat(document.getElementById('budget-amount').value);
            if (!budget || budget < 1000) {
                alert('Informe um valor v√°lido (m√≠nimo R$ 1.000)');
                return;
            }
            
            const rooms = {};
            ['cozinha', 'banheiro', 'quarto', 'sala'].forEach(room => {
                if (document.getElementById('rev-' + room).checked) {
                    const area = parseFloat(document.getElementById('rev-' + room + '-area').value);
                    if (area > 0) rooms[room] = area;
                }
            });
            
            if (Object.keys(rooms).length === 0) {
                alert('Selecione pelo menos um c√¥modo!');
                return;
            }
            
            const costs = {};
            for (let room in rooms) {
                costs[room] = estimateRoomCost(room, rooms[room]);
            }
            
            const sorted = Object.entries(costs).sort((a, b) => a[1] - b[1]);
            
            let html = '<div class="result">';
            html += '<h2>üéØ Sua Melhor Estrat√©gia</h2>';
            
            sorted.forEach(([room, cost]) => {
                const canAfford = cost <= budget;
                const roomName = {cozinha: 'üç≥ Cozinha', banheiro: 'üöø Banheiro', quarto: 'üõèÔ∏è Quarto', sala: 'üõãÔ∏è Sala'}[room];
                
                html += '<div class="reverse-card">';
                html += `<h3>${roomName} (${rooms[room]}m¬≤)</h3>`;
                html += `<div class="included">‚úÖ Inclu√≠do: Piso + ${room === 'cozinha' || room === 'banheiro' ? 'Revestimento' : 'Pintura'}</div>`;
                
                if (room === 'cozinha') {
                    html += `<div class="included">‚úÖ Pia atual: Mantida</div>`;
                    html += `<div class="optional">üí° Para trocar pia: +R$ 800 = R$ ${formatCurrency(cost + 800)}</div>`;
                } else if (room === 'banheiro') {
                    html += `<div class="included">‚úÖ Lou√ßas atuais: Mantidas</div>`;
                    html += `<div class="optional">üí° Para trocar lou√ßas: +R$ 1.200 = R$ ${formatCurrency(cost + 1200)}</div>`;
                }
                
                html += `<div style="font-size: 1.5em; color: ${canAfford ? '#66bb6a' : '#ef5350'}; font-weight: bold; margin-top: 10px;">R$ ${formatCurrency(cost)} ${canAfford ? '‚úÖ' : '‚ùå'}</div>`;
                html += '</div>';
            });
            
            let accumulated = 0;
            let sequence = [];
            for (let [room, cost] of sorted) {
                if (accumulated + cost <= budget) {
                    accumulated += cost;
                    sequence.push({room, cost});
                }
            }
            
            if (sequence.length > 0) {
                html += '<div style="background: #e8f5e9; padding: 20px; border-radius: 10px; border: 2px solid #66bb6a;">';
                html += `<h3>‚úÖ Com R$ ${formatCurrency(budget)}, voc√™ consegue:</h3>`;
                sequence.forEach((item, idx) => {
                    const roomName = {cozinha: 'Cozinha', banheiro: 'Banheiro', quarto: 'Quarto', sala: 'Sala'}[item.room];
                    html += `<div style="margin: 10px 0;">${idx + 1}¬∫ ${roomName} (${rooms[item.room]}m¬≤) - R$ ${formatCurrency(item.cost)}</div>`;
                });
                html += `<div style="font-size: 1.3em; font-weight: bold; margin-top: 15px;">Total: R$ ${formatCurrency(accumulated)}</div>`;
                html += `<div style="color: #66bb6a; font-weight: bold;">Sobra: R$ ${formatCurrency(budget - accumulated)}</div>`;
                html += '</div>';
            } else {
                html += '<div style="background: #ffebee; padding: 20px; border-radius: 10px; border: 2px solid #ef5350;">';
                html += '<h3>‚ùå Or√ßamento insuficiente</h3>';
                html += '<p>Considere: reduzir √°rea, escolher materiais mais econ√¥micos ou aumentar o or√ßamento.</p>';
                html += '</div>';
            }
            
            html += '</div>';
            document.getElementById('reverse-result').innerHTML = html;
        }
        
        function estimateRoomCost(room, area) {
            let cost = 0;
            if (room === 'cozinha' || room === 'banheiro') {
                cost += area * 95 * currentState;
                cost += (area * 2) * 75 * currentState;
                if (room === 'banheiro') cost += 0;
            } else {
                cost += area * 85 * currentState;
                cost += (area * 3.8) * 25 * currentState;
            }
            cost += cost * 0.50;
            cost += cost * 0.175;
            return cost;
        }
        
        function initTracking() {
            const projectName = document.getElementById('project-name').value;
            const totalDays = parseInt(document.getElementById('total-days').value);
            
            if (!projectName || !totalDays) {
                alert('Preencha nome e prazo!');
                return;
            }
            
            trackingSteps = [
                {name: 'Demoli√ß√£o', days: Math.ceil(totalDays * 0.10), completed: false},
                {name: 'Instala√ß√£o Piso', days: Math.ceil(totalDays * 0.25), completed: false},
                {name: 'Revestimento Paredes', days: Math.ceil(totalDays * 0.25), completed: false},
                {name: 'Instala√ß√µes (El√©trica/Hidr√°ulica)', days: Math.ceil(totalDays * 0.20), completed: false},
                {name: 'Pintura', days: Math.ceil(totalDays * 0.15), completed: false},
                {name: 'Acabamentos Finais', days: Math.ceil(totalDays * 0.05), completed: false}
            ];
            
            document.getElementById('tracking-content').classList.remove('hidden');
            updateTracking();
        }
        
        function updateTracking() {
            const container = document.getElementById('tracking-items');
            container.innerHTML = '';
            
            let completed = 0;
            let daysWorked = 0;
            
            trackingSteps.forEach((step, idx) => {
                const div = document.createElement('div');
                div.className = 'tracking-item' + (step.completed ? ' completed' : '');
                div.innerHTML = `
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div>
                            <input type="checkbox" ${step.completed ? 'checked' : ''} 
                                   onchange="toggleStep(${idx})">
                            <strong>${step.name}</strong> (${step.days} dias)
                        </div>
                        <span>${step.completed ? '‚úÖ Conclu√≠do' : '‚è≥ Pendente'}</span>
                    </div>
                `;
                container.appendChild(div);
                
                if (step.completed) {
                    completed++;
                    daysWorked += step.days;
                }
            });
            
            const progress = Math.round((completed / trackingSteps.length) * 100);
            document.getElementById('progress-fill').style.width = progress + '%';
            document.getElementById('progress-fill').textContent = progress + '%';
            document.getElementById('days-worked').textContent = daysWorked;
        }
        
        function toggleStep(idx) {
            trackingSteps[idx].completed = !trackingSteps[idx].completed;
            updateTracking();
        }
        
        showScreen('home');
    </script>
</body>
</html>